# SPDX-License-Identifier: MIT                                                
# Copyright (c) 2021 GPUFORT Advanced Micro Devices, Inc. All rights reserved.
class CufLoopKernel2Omp(CufBackendBase):
    def transform(self,joined_lines,joined_statements,statements_fully_cover_lines,index_hints=[]):
        """
        Analyze based on statements but modify original lines if these are
        fully covered by the statements.
        """
        try:
           parse_result = translator.loop_kernel.parseString(joined_statements)[0]
           snippet     = joined_lines if statements_fully_cover_lines else joined_statements
           return parse_result.omp_f_str(snippet), True 
        except Exception as e:
           print("failed: "+f_snippet) #TODO error handling
           raise e
           return "", False 

register_cuf_backend("omp",CufLoopKernel2Omp,None)