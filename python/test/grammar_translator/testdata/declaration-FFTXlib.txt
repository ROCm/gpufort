INTEGER::current_size=0
COMPLEX(DP),ALLOCATABLE::dev_space_fftparallel(:)
COMPLEX(DP),ALLOCATABLE::dev_space_scatter_dblbuffer(:)
COMPLEX(DP),ALLOCATABLE::pin_space_scatter_dblbuffer(:)
COMPLEX(DP),ALLOCATABLE::pin_space_scatter_in(:)
COMPLEX(DP),ALLOCATABLE::pin_space_scatter_out(:)
TYPE(fft_type_descriptor),INTENT(in)::desc
INTEGER,OPTIONAL,INTENT(IN)::howmany
INTEGER::howmany_
INTEGER::info
CHARACTER(LEN=*),INTENT(IN)::calling_routine,message
INTEGER,INTENT(IN)::ierr
CHARACTER(LEN=6)::cerr
INTEGER::info
TYPE(fft_type_descriptor),INTENT(IN)::dfft
CHARACTER(LEN=*),INTENT(IN)::fft_kind
COMPLEX(DP)::f(:)
INTEGER,OPTIONAL,INTENT(IN)::howmany
INTEGER::howmany_=1
CHARACTER(LEN=12)::clock_label
TYPE(fft_type_descriptor),INTENT(IN)::dfft
CHARACTER(LEN=*),INTENT(IN)::fft_kind
COMPLEX(DP)::f(:)
INTEGER,OPTIONAL,INTENT(IN)::howmany
INTEGER::howmany_=1
CHARACTER(LEN=12)::clock_label
TYPE(fft_box_descriptor),INTENT(IN)::dfft
INTEGER,INTENT(IN)::ia
COMPLEX(DP)::f(:)
TYPE(fft_type_descriptor),INTENT(IN)::dfft
CHARACTER(LEN=*),INTENT(IN)::fft_kind
COMPLEX(DP),DEVICE::f_d(:)
INTEGER,OPTIONAL,INTENT(IN)::howmany
INTEGER(kind=cuda_stream_kind),OPTIONAL,INTENT(IN)::stream
INTEGER::howmany_=1
INTEGER(kind=cuda_stream_kind)::stream_=0
CHARACTER(LEN=12)::clock_label
TYPE(fft_type_descriptor),INTENT(IN)::dfft
CHARACTER(LEN=*),INTENT(IN)::fft_kind
COMPLEX(DP),DEVICE::f_d(:)
INTEGER,OPTIONAL,INTENT(IN)::howmany
INTEGER(kind=cuda_stream_kind),OPTIONAL,INTENT(IN)::stream
INTEGER::howmany_=1
INTEGER(kind=cuda_stream_kind)::stream_=0
CHARACTER(LEN=12)::clock_label
TYPE(fft_type_descriptor),INTENT(inout)::dfft
REAL(DP),INTENT(IN)::g(:,:)
REAL(DP),INTENT(IN)::at(:,:)
INTEGER,OPTIONAL,INTENT(OUT)::mill(:,:)
INTEGER::ng,n1,n2,n3
TYPE(fft_type_descriptor),INTENT(in)::desc
INTEGER,INTENT(IN)::ispin
LOGICAL,INTENT(IN)::noncolin,domag
REAL(DP),INTENT(INOUT)::tg_rho(:)
REAL(DP),INTENT(INOUT)::tg_rho_nc(:,:)
REAL(DP),INTENT(OUT)::rhos(:,:)
INTEGER::ierr,ioff,idx,ir3,ir,ipol,ioff_tg,nxyp,npol_
TYPE(fft_type_descriptor),INTENT(in)::desc
INTEGER,INTENT(IN)::ispin
REAL(DP),INTENT(INOUT)::tmp_rhos(:)
REAL(DP),INTENT(OUT)::rhos(:,:)
INTEGER::ierr,ioff,idx,ir3,nxyp,ioff_tg
TYPE(fft_type_descriptor),INTENT(in)::desc
REAL(DP),INTENT(INOUT)::tmp_rhos(:,:)
REAL(DP),INTENT(OUT)::rhos(:,:)
INTEGER::ierr,from,ir3,ioff,nxyp,ioff_tg
TYPE(fft_type_descriptor),INTENT(in)::desc
COMPLEX(DP),INTENT(INOUT)::tmp_rhos(:)
COMPLEX(DP),INTENT(OUT)::rhos(:)
INTEGER::ierr,from,ir3,ioff,nxyp,ioff_tg
TYPE(fft_type_descriptor),INTENT(in)::desc
COMPLEX(DP),INTENT(INOUT)::tmp_rhos(:,:)
COMPLEX(DP),INTENT(OUT)::rhos(:,:)
INTEGER::ierr,from,ir3,ioff,nxyp,ioff_tg
TYPE(fft_type_descriptor),INTENT(in)::desc
INTEGER,INTENT(OUT)::right_nnr
TYPE(fft_type_descriptor),INTENT(in)::desc
INTEGER,INTENT(OUT)::val
TYPE(fft_type_descriptor),INTENT(in)::desc
INTEGER,INTENT(OUT)::val
TYPE(fft_type_descriptor),INTENT(in)::desc
INTEGER,INTENT(OUT)::val
INTEGER::fftx_ntgrp
TYPE(fft_type_descriptor),INTENT(in)::desc
INTEGER::fftx_tgpe
TYPE(fft_type_descriptor),INTENT(in)::desc
INTEGER::fftx_tgcomm
TYPE(fft_type_descriptor),INTENT(in)::desc
TYPE(fft_type_descriptor),INTENT(in)::desc
REAL(DP),INTENT(INOUT)::r(:,:)
REAL(DP),INTENT(IN)::f(:)
INTEGER::nspin,ir
TYPE(fft_type_descriptor),INTENT(in)::desc
complex(DP),INTENT(OUT)::psi(:)
complex(DP),INTENT(IN)::c(:)
complex(DP),OPTIONAL,INTENT(IN)::ca(:)
complex(DP),parameter::ci=(0.0d0,1.0d0)
integer::ig
TYPE(fft_type_descriptor),INTENT(in)::desc
complex(DP),INTENT(OUT)::psi(:)
complex(DP),INTENT(IN)::c(:)
INTEGER,INTENT(IN)::igk(:),ngk
integer::ig
TYPE(fft_type_descriptor),INTENT(in)::desc
complex(DP),INTENT(OUT)::psi(:)
complex(DP),INTENT(IN)::c(:)
complex(DP),OPTIONAL,INTENT(IN)::ca(:)
complex(DP),parameter::ci=(0.0d0,1.0d0)
integer::ig
TYPE(fft_type_descriptor),INTENT(in)::desc
complex(DP),INTENT(INOUT)::vout1(:)
complex(DP),OPTIONAL,INTENT(INOUT)::vout2(:)
complex(DP),INTENT(IN)::vin(:)
COMPLEX(DP)::fp,fm
INTEGER::ig
TYPE(fft_type_descriptor),INTENT(in)::desc
complex(DP),INTENT(OUT)::vout1(:)
complex(DP),OPTIONAL,INTENT(OUT)::vout2(:)
complex(DP),INTENT(IN)::vin(:)
COMPLEX(DP)::fp,fm
INTEGER::ig
TYPE(fft_type_descriptor),INTENT(in)::desc
complex(DP),INTENT(OUT)::vout1(:)
complex(DP),OPTIONAL,INTENT(OUT)::vout2(:)
complex(DP),INTENT(IN)::vin(:)
COMPLEX(DP)::fp,fm
INTEGER::ig
TYPE(fft_type_descriptor),INTENT(in)::desc
complex(DP),INTENT(OUT)::psis(:)
complex(DP),INTENT(INOUT)::c_bgrp(:,:)
INTEGER,INTENT(IN)::i,nbsp_bgrp
INTEGER::eig_offset,eig_index,right_nnr
INTEGER,INTENT(IN)::unit
TYPE(fft_type_descriptor),INTENT(in)::desc
INTEGER::i,j,nr3l
CHARACTER(LEN=*),INTENT(IN)::fft_kind
TYPE(fft_type_descriptor),INTENT(IN)::dfft
INTEGER,OPTIONAL,INTENT(IN)::howmany
COMPLEX(DP)::f(:)
INTEGER,INTENT(IN)::ia
TYPE(fft_box_descriptor),INTENT(IN)::dfft
COMPLEX(DP)::f(:)
CHARACTER(LEN=*),INTENT(IN)::grid_type
TYPE(fft_type_descriptor),INTENT(IN)::dfft
INTEGER,OPTIONAL,INTENT(IN)::howmany
INTEGER(kind=cuda_stream_kind),OPTIONAL,INTENT(IN)::stream
COMPLEX(DP),DEVICE::f_d(:)
CHARACTER(LEN=*),INTENT(IN)::fft_kind
TYPE(fft_type_descriptor),INTENT(IN)::dfft
INTEGER,OPTIONAL,INTENT(IN)::howmany
COMPLEX(DP)::f(:)
CHARACTER(LEN=*),INTENT(IN)::grid_type
TYPE(fft_type_descriptor),INTENT(IN)::dfft
INTEGER,OPTIONAL,INTENT(IN)::howmany
INTEGER(kind=cuda_stream_kind),OPTIONAL,INTENT(IN)::stream
COMPLEX(DP),DEVICE::f_d(:)
TYPE(fft_type_descriptor),INTENT(IN)::dfft_in,dfft_out
REAL(DP),INTENT(IN)::v_in(:)
REAL(DP),INTENT(OUT)::v_out(:)
TYPE(fft_type_descriptor),INTENT(IN)::dfft_in,dfft_out
COMPLEX(DP),INTENT(IN)::v_in(:)
COMPLEX(DP),INTENT(OUT)::v_out(:)
TYPE(fft_type_descriptor),INTENT(IN)::dfft_in,dfft_out
REAL(DP),INTENT(IN)::v_in(:)
REAL(DP),INTENT(OUT)::v_out(:)
INTEGER::ngm
COMPLEX(DP),ALLOCATABLE::aux_in(:),aux_out(:)
TYPE(fft_type_descriptor),INTENT(IN)::dfft_in,dfft_out
COMPLEX(DP),INTENT(IN)::v_in(:)
COMPLEX(DP),INTENT(OUT)::v_out(:)
INTEGER::ngm
COMPLEX(DP),ALLOCATABLE::aux_in(:)
TYPE(fft_type_descriptor),INTENT(in)::dfft
COMPLEX(DP),INTENT(inout)::f(:)
INTEGER,INTENT(in)::isgn
INTEGER::n1,n2,n3,nx1,nx2,nx3
INTEGER::nnr_
INTEGER::nsticks_x,nsticks_y,nsticks_z
COMPLEX(DP),ALLOCATABLE::aux(:)
INTEGER::i
TYPE(fft_type_descriptor),INTENT(in)::dfft
COMPLEX(DP),DEVICE,INTENT(inout)::f_d(:)
INTEGER,INTENT(in)::isgn
INTEGER::n1,n2,n3,nx1,nx2,nx3
INTEGER::nnr_
INTEGER::nsticks_x,nsticks_y,nsticks_z
INTEGER::ierr,i
INTEGER(kind=cuda_stream_kind)::stream=0
TYPE(fft_type_descriptor),INTENT(in)::dfft
COMPLEX(DP),DEVICE,INTENT(inout)::f_d(:)
INTEGER,INTENT(in)::isgn
INTEGER,INTENT(in)::howmany
INTEGER::n1,n2,n3,nx1,nx2,nx3
INTEGER::nnr_
INTEGER::nsticks_x,nsticks_y,nsticks_z
INTEGER::nsticks_zx
INTEGER::ierr,i,j
INTEGER::nstreams
INTEGER(kind=cuda_stream_kind)::stream=0
TYPE(fft_type_descriptor),INTENT(IN)::dfft
INTEGER,INTENT(IN)::i,j,k
COMPLEX(DP),INTENT(IN)::f(:)
INTEGER::kk,ii,jj,ip,ierr
COMPLEX(DP)::f_aux
TYPE(fft_type_descriptor),INTENT(IN)::dfft
INTEGER,INTENT(IN)::i,j,k
COMPLEX(DP),INTENT(IN)::f_in
COMPLEX(DP),INTENT(INOUT)::f(:)
INTEGER::kk,ii,jj,ip,ierr
INTEGER,INTENT(IN)::i,j,k
COMPLEX(DP),INTENT(IN)::f(:)
TYPE(fft_type_descriptor),INTENT(IN)::dfft
INTEGER::ii,jj,ip,ierr
COMPLEX(DP)::f_aux
COMPLEX(DP),INTENT(IN)::f_in
INTEGER,INTENT(IN)::i,j,k
COMPLEX(DP),INTENT(INOUT)::f(:)
TYPE(fft_type_descriptor),INTENT(IN)::dfft
INTEGER::ii,jj
COMPLEX(DP),INTENT(inout)::f(:)
TYPE(fft_type_descriptor),INTENT(in)::dfft
INTEGER,INTENT(in)::isgn
INTEGER::me_p
INTEGER::n1,n2,n3,nx1,nx2,nx3
COMPLEX(DP),ALLOCATABLE::aux(:)
INTEGER::planes(dfft%nr1x)
INTEGER,INTENT(in)::iopt
INTEGER,INTENT(in)::iopt
TYPE(fft_type_descriptor),INTENT(in)::dfft
COMPLEX(DP),DEVICE,INTENT(inout)::f_d(dfft%nnr)
INTEGER,INTENT(in)::isgn
INTEGER::me_p,istat
INTEGER::n1,n2,n3,nx1,nx2,nx3
COMPLEX(DP),ALLOCATABLE::yf(:)
INTEGER::planes(dfft%nr1x)
INTEGER(kind=cuda_stream_kind)::stream=0
INTEGER,INTENT(in)::iopt
INTEGER,INTENT(in)::iopt
TYPE(fft_type_descriptor),INTENT(in)::dfft
INTEGER,INTENT(in)::isgn
INTEGER,INTENT(in)::batchsize
COMPLEX(DP),DEVICE,INTENT(inout)::f_d(batchsize*dfft%nnr)
INTEGER::me_p,istat,i,j,currsize
INTEGER::n1,n2,n3,nx1,nx2,nx3,ncpx,nppx,proc
COMPLEX(DP),ALLOCATABLE::yf(:)
INTEGER::planes(dfft%nr1x)
INTEGER::sticks(dfft%nproc)
INTEGER(kind=cuda_stream_kind)::stream=0
INTEGER,PARAMETER::MPI_COMM_NULL=0
INTEGER,PARAMETER::ndims=10
INTEGER,PARAMETER::nfftx=2049
INTEGER,PARAMETER::DP=selected_real_kind(14,200)
INTEGER,PARAMETER::stdout=6
REAL(DP),PARAMETER::eps8=1.0E-8_DP
INTEGER,INTENT(IN)::isign
INTEGER,INTENT(IN)::nsl,nz,ldz
COMPLEX(DP)::c(:),cout(:)
REAL(DP)::tscale
INTEGER::i,err,idir,ip,void
INTEGER,SAVE::zdims(3,ndims)=-1
INTEGER,SAVE::icurrent=1
LOGICAL::found
INTEGER::tid
INTEGER::offset,ldz_t
INTEGER::omp_get_max_threads
INTEGER,PARAMETER::ltabl=3*nfftx+100
INTEGER::INFO
COMPLEX(DP),SAVE::fw_tablez(ltabl,ndims)
COMPLEX(DP),SAVE::bw_tablez(ltabl,ndims)
INTEGER,INTENT(IN)::isign,ldx,ldy,nx,ny,nzl
INTEGER,OPTIONAL,INTENT(IN)::pl2ix(:)
COMPLEX(DP)::r(:)
INTEGER::i,k,j,err,idir,ip,kk,void
REAL(DP)::tscale
INTEGER,SAVE::icurrent=1
INTEGER,SAVE::dims(4,ndims)=-1
LOGICAL::dofft(nfftx),found
INTEGER,PARAMETER::stdout=6
INTEGER::offset
INTEGER::nx_t,ny_t,nzl_t,ldx_t,ldy_t
INTEGER::itid,mytid,ntids
INTEGER::omp_get_thread_num,omp_get_num_threads,omp_get_max_threads
INTEGER,PARAMETER::ltabl=3*nfftx+100
INTEGER::INFO
COMPLEX(DP),SAVE::fw_tablex(ltabl,ndims),bw_tablex(ltabl,ndims)
COMPLEX(DP),SAVE::fw_tabley(ltabl,ndims),bw_tabley(ltabl,ndims)
INTEGER,INTENT(IN)::nx,ny,nz,ldx,ldy,ldz,howmany,isign
COMPLEX(DP)::f(:)
INTEGER::i,k,j,err,idir,ip
REAL(DP)::tscale
INTEGER,SAVE::icurrent=1
INTEGER,SAVE::dims(3,ndims)=-1
INTEGER,PARAMETER::ltabl=4*nfftx+300
INTEGER::INFO
COMPLEX(DP),SAVE::fw_table(ltabl,ndims)
COMPLEX(DP),SAVE::bw_table(ltabl,ndims)
TYPE(C_PTR),save::fw_plan(ndims)=C_NULL_PTR
TYPE(C_PTR),save::bw_plan(ndims)=C_NULL_PTR
integer::nx,ny,nz,ldx,ldy,ldz,howmany,isign
complex(DP)::f(ldx*ldy*ldz)
integer::do_fft_y(:),do_fft_z(:)
integer::m,incx1,incx2
INTEGER::i,k,j,err,idir,ip,ii,jj
REAL(DP)::tscale
INTEGER,SAVE::icurrent=1
INTEGER,SAVE::dims(3,ndims)=-1
INTEGER,PARAMETER::ltabl=3*nfftx+100
INTEGER::INFO
COMPLEX(DP),SAVE::fw_table(ltabl,3,ndims)
COMPLEX(DP),SAVE::bw_table(ltabl,3,ndims)
TYPE(DFTI_DESCRIPTOR),POINTER::desc
INTEGER,INTENT(IN)::isign
INTEGER,INTENT(IN)::nsl,nz,ldz
COMPLEX(DP)::c(:),cout(:)
REAL(DP)::tscale
INTEGER::i,err,idir,ip,void
INTEGER,SAVE::zdims(3,ndims)=-1
INTEGER,SAVE::icurrent=1
LOGICAL::found
INTEGER::tid
INTEGER::offset,ldz_t
INTEGER::omp_get_max_threads
TYPE(DFTI_DESCRIPTOR_ARRAY),SAVE::hand(ndims)
LOGICAL,SAVE::dfti_first=.TRUE.
INTEGER::dfti_status=0
INTEGER,INTENT(IN)::isign,ldx,ldy,nx,ny,nzl
INTEGER,OPTIONAL,INTENT(IN)::pl2ix(:)
COMPLEX(DP)::r(:)
INTEGER::i,k,j,err,idir,ip,kk,void
REAL(DP)::tscale
INTEGER,SAVE::icurrent=1
INTEGER,SAVE::dims(4,ndims)=-1
LOGICAL::dofft(nfftx),found
INTEGER,PARAMETER::stdout=6
INTEGER::offset
INTEGER::nx_t,ny_t,nzl_t,ldx_t,ldy_t
INTEGER::itid,mytid,ntids
INTEGER::omp_get_thread_num,omp_get_num_threads,omp_get_max_threads
TYPE(DFTI_DESCRIPTOR_ARRAY),SAVE::hand(ndims)
LOGICAL,SAVE::dfti_first=.TRUE.
INTEGER::dfti_status=0
INTEGER,INTENT(IN)::nx,ny,nz,ldx,ldy,ldz,howmany,isign
COMPLEX(DP)::f(:)
INTEGER::i,k,j,err,idir,ip
REAL(DP)::tscale
INTEGER,SAVE::icurrent=1
INTEGER,SAVE::dims(4,ndims)=-1
TYPE(DFTI_DESCRIPTOR_ARRAY),SAVE::hand(ndims)
LOGICAL,SAVE::dfti_first=.TRUE.
INTEGER::dfti_status=0
integer::nx,ny,nz,ldx,ldy,ldz,isign,howmany
complex(DP)::f(ldx*ldy*ldz)
integer::do_fft_y(:),do_fft_z(:)
INTEGER,PARAMETER::lwork=20000+(2*nfftx+256)*64+3*nfftx
REAL(DP)::work(lwork)
INTEGER,INTENT(IN)::isign
INTEGER,INTENT(IN)::nsl,nz,ldz
COMPLEX(DP)::c(:),cout(:)
REAL(DP)::tscale
INTEGER::i,err,idir,ip,void
INTEGER,SAVE::zdims(3,ndims)=-1
INTEGER,SAVE::icurrent=1
LOGICAL::done
INTEGER::tid
INTEGER::offset,ldz_t
INTEGER::omp_get_max_threads
INTEGER,PARAMETER::ltabl=20000+3*nfftx
REAL(DP),SAVE::fw_tablez(ltabl,ndims)
REAL(DP),SAVE::bw_tablez(ltabl,ndims)
INTEGER,INTENT(IN)::isign,ldx,ldy,nx,ny,nzl
INTEGER,OPTIONAL,INTENT(IN)::pl2ix(:)
COMPLEX(DP)::r(:)
INTEGER::i,k,j,err,idir,ip,kk,void
REAL(DP)::tscale
INTEGER,SAVE::icurrent=1
INTEGER,SAVE::dims(4,ndims)=-1
LOGICAL::dofft(nfftx),done
INTEGER,PARAMETER::stdout=6
INTEGER::offset
INTEGER::nx_t,ny_t,nzl_t,ldx_t,ldy_t
INTEGER::itid,mytid,ntids
INTEGER::omp_get_thread_num,omp_get_num_threads,omp_get_max_threads
INTEGER,PARAMETER::ltabl=20000+3*nfftx
REAL(DP),SAVE::fw_tablex(ltabl,ndims),fw_tabley(ltabl,ndims)
REAL(DP),SAVE::bw_tablex(ltabl,ndims),bw_tabley(ltabl,ndims)
INTEGER,INTENT(IN)::nx,ny,nz,ldx,ldy,ldz,howmany,isign
COMPLEX(DP)::f(:)
INTEGER::i,k,j,err,idir,ip
REAL(DP)::tscale
INTEGER,SAVE::icurrent=1
INTEGER,SAVE::dims(3,ndims)=-1
integer::nx,ny,nz,ldx,ldy,ldz,howmany,isign
complex(DP)::f(ldx*ldy*ldz)
integer::do_fft_y(:),do_fft_z(:)
integer::m,incx1,incx2
INTEGER::i,k,j,err,idir,ip,ii,jj
REAL(DP)::tscale
INTEGER,SAVE::icurrent=1
INTEGER,SAVE::dims(3,ndims)=-1
INTEGER,PARAMETER::ltabl=20000+3*nfftx
REAL(DP),SAVE::fw_table(ltabl,3,ndims)
REAL(DP),SAVE::bw_table(ltabl,3,ndims)
INTEGER,INTENT(IN)::isign
INTEGER,INTENT(IN)::nsl,nz,ldz
COMPLEX(DP)::c(:),cout(:)
REAL(DP)::tscale
INTEGER::i,err,idir,ip,void
INTEGER,SAVE::zdims(3,ndims)=-1
INTEGER,SAVE::icurrent=1
LOGICAL::found
INTEGER::tid
INTEGER::offset,ldz_t
INTEGER::omp_get_max_threads
TYPE(C_PTR),SAVE::fw_planz(ndims)=C_NULL_PTR
TYPE(C_PTR),SAVE::bw_planz(ndims)=C_NULL_PTR
INTEGER,INTENT(IN)::isign,ldx,ldy,nx,ny,nzl
INTEGER,OPTIONAL,INTENT(IN)::pl2ix(:)
COMPLEX(DP)::r(:)
INTEGER::i,k,j,err,idir,ip,kk,void
REAL(DP)::tscale
INTEGER,SAVE::icurrent=1
INTEGER,SAVE::dims(4,ndims)=-1
LOGICAL::dofft(nfftx),found
INTEGER,PARAMETER::stdout=6
INTEGER::offset
INTEGER::nx_t,ny_t,nzl_t,ldx_t,ldy_t
INTEGER::itid,mytid,ntids
INTEGER::omp_get_thread_num,omp_get_num_threads,omp_get_max_threads
TYPE(C_PTR),SAVE::fw_plan_2d(ndims)=C_NULL_PTR
TYPE(C_PTR),SAVE::bw_plan_2d(ndims)=C_NULL_PTR
TYPE(C_PTR),SAVE::fw_plan(2,ndims)=C_NULL_PTR
TYPE(C_PTR),SAVE::bw_plan(2,ndims)=C_NULL_PTR
INTEGER,INTENT(IN)::nx,ny,nz,ldx,ldy,ldz,howmany,isign
COMPLEX(DP)::f(:)
INTEGER::i,k,j,err,idir,ip
REAL(DP)::tscale
INTEGER,SAVE::icurrent=1
INTEGER,SAVE::dims(3,ndims)=-1
TYPE(C_PTR),save::fw_plan(ndims)=C_NULL_PTR
TYPE(C_PTR),save::bw_plan(ndims)=C_NULL_PTR
integer::nx,ny,nz,ldx,ldy,ldz,howmany,isign
complex(DP)::f(ldx*ldy*ldz*howmany)
integer::do_fft_z(:),do_fft_y(:)
integer::m,incx1,incx2
INTEGER::i,k,j,err,idir,ip,ii,jj,h,ldh
REAL(DP)::tscale
INTEGER,SAVE::icurrent=1
INTEGER,SAVE::dims(3,ndims)=-1
TYPE(C_PTR),SAVE::fw_plan(3,ndims)=C_NULL_PTR
TYPE(C_PTR),SAVE::bw_plan(3,ndims)=C_NULL_PTR
INTEGER,INTENT(IN)::isign
INTEGER,INTENT(IN)::nsl,nz,ldz
COMPLEX(DP)::c(:),cout(:)
REAL(DP)::tscale
INTEGER::i,err,idir,ip,void
INTEGER,SAVE::zdims(3,ndims)=-1
INTEGER,SAVE::icurrent=1
LOGICAL::done
INTEGER::tid
INTEGER::offset,ldz_t
INTEGER::omp_get_max_threads
TYPE(C_PTR),SAVE::fw_planz(ndims)=C_NULL_PTR
TYPE(C_PTR),SAVE::bw_planz(ndims)=C_NULL_PTR
INTEGER,INTENT(IN)::isign,ldx,ldy,nx,ny,nzl
INTEGER,OPTIONAL,INTENT(IN)::pl2ix(:)
COMPLEX(DP)::r(:)
INTEGER::i,k,j,err,idir,ip,kk,void
REAL(DP)::tscale
INTEGER,SAVE::icurrent=1
INTEGER,SAVE::dims(4,ndims)=-1
LOGICAL::dofft(nfftx),done
INTEGER,PARAMETER::stdout=6
INTEGER::offset
INTEGER::nx_t,ny_t,nzl_t,ldx_t,ldy_t
INTEGER::itid,mytid,ntids
INTEGER::omp_get_thread_num,omp_get_num_threads,omp_get_max_threads
TYPE(C_PTR),SAVE::fw_plan(2,ndims)=C_NULL_PTR
TYPE(C_PTR),SAVE::bw_plan(2,ndims)=C_NULL_PTR
INTEGER,INTENT(IN)::nx,ny,nz,ldx,ldy,ldz,howmany,isign
COMPLEX(DP)::f(:)
INTEGER::i,k,j,err,idir,ip
REAL(DP)::tscale
INTEGER,SAVE::icurrent=1
INTEGER,SAVE::dims(3,ndims)=-1
TYPE(C_PTR),save::fw_plan(ndims)=C_NULL_PTR
TYPE(C_PTR),save::bw_plan(ndims)=C_NULL_PTR
INTEGER,PARAMETER::stdout=6
integer::nx,ny,nz,ldx,ldy,ldz,howmany,isign
complex(DP)::f(ldx*ldy*ldz)
integer::do_fft_y(:),do_fft_z(:)
integer::m,incx1,incx2
INTEGER::i,k,j,err,idir,ip,ii,jj
REAL(DP)::tscale
INTEGER,SAVE::icurrent=1
INTEGER,SAVE::dims(3,ndims)=-1
TYPE(C_PTR),SAVE::fw_plan(3,ndims)=C_NULL_PTR
TYPE(C_PTR),SAVE::bw_plan(3,ndims)=C_NULL_PTR
INTEGER,INTENT(IN)::isign
INTEGER,INTENT(IN)::nsl,nz,ldz
COMPLEX(DP)::c(:),cout(:)
REAL(DP)::tscale
INTEGER::i,err,idir,ip,void
INTEGER,SAVE::zdims(3,ndims)=-1
INTEGER,SAVE::icurrent=1
LOGICAL::done
INTEGER::tid
INTEGER::offset,ldz_t
INTEGER::omp_get_max_threads
INTEGER,PARAMETER::ltabl=2*nfftx+64
REAL(DP),SAVE::tablez(ltabl,ndims)
REAL(DP)::work(4*nz*nsl)
COMPLEX(DP)::DUMMY
INTEGER,SAVE::isys=1
INTEGER,INTENT(IN)::isign,ldx,ldy,nx,ny,nzl
INTEGER,OPTIONAL,INTENT(IN)::pl2ix(:)
COMPLEX(DP)::r(:)
INTEGER::i,k,j,err,idir,ip,kk,void
REAL(DP)::tscale
INTEGER,SAVE::icurrent=1
INTEGER,SAVE::dims(4,ndims)=-1
LOGICAL::dofft(nfftx),done
INTEGER,PARAMETER::stdout=6
INTEGER::offset
INTEGER::nx_t,ny_t,nzl_t,ldx_t,ldy_t
INTEGER::itid,mytid,ntids
INTEGER::omp_get_thread_num,omp_get_num_threads,omp_get_max_threads
INTEGER,PARAMETER::ltabl=2*nfftx+64
REAL(DP),SAVE::tablex(ltabl,ndims),tabley(ltabl,ndims)
REAL(DP)::work(4*nx*ny)
COMPLEX(DP)::XY(ldx*ny)
COMPLEX(DP)::DUMMY
INTEGER,SAVE::isys=1
INTEGER,INTENT(IN)::nx,ny,nz,ldx,ldy,ldz,howmany,isign
COMPLEX(DP)::f(:)
INTEGER::i,k,j,err,idir,ip
REAL(DP)::tscale
INTEGER,SAVE::icurrent=1
INTEGER,SAVE::dims(3,ndims)=-1
INTEGER,PARAMETER::ltabl=60
INTEGER,PARAMETER::lwork=195+6*nfftx
INTEGER,SAVE::iw0(ltabl,ndims)
INTEGER::k_off,kj_offset
REAL(DP),SAVE::auxp(lwork,ndims)
COMPLEX(DP),DIMENSION(:),ALLOCATABLE::cw2
COMPLEX(DP)::f_out(size(f))
INTEGER::nbtasks
integer::nx,ny,nz,ldx,ldy,ldz,howmany,isign
complex(DP)::f(ldx*ldy*ldz)
integer::do_fft_y(:),do_fft_z(:)
integer::m,incx1,incx2
INTEGER::i,k,j,err,idir,ip,ii,jj
REAL(DP)::tscale
INTEGER,SAVE::icurrent=1
INTEGER,SAVE::dims(3,ndims)=-1
INTEGER,INTENT(IN)::isign
INTEGER,INTENT(IN)::nsl,nz,ldz
INTEGER(kind=cuda_stream_kind)::stream
LOGICAL,INTENT(IN),optional::in_place
COMPLEX(DP),DEVICE::c_d(:),cout_d(:)
REAL(DP)::tscale
INTEGER::i,err,idir,ip,void,istat
REAL(DP),SAVE::zflops(ndims)=0.d0
INTEGER,SAVE::zdims(3,ndims)=-1
INTEGER,SAVE::icurrent=1
LOGICAL::found
LOGICAL::is_inplace
INTEGER::tid
INTEGER,SAVE::cufft_planz(ndims)=0
INTEGER,PARAMETER::RANK=1
INTEGER::FFT_DIM(RANK),DATA_DIM(RANK)
INTEGER::STRIDE,DIST,BATCH
INTEGER,INTENT(IN)::isign,ldx,ldy,nx,ny,nzl
INTEGER(kind=cuda_stream_kind)::stream
INTEGER,OPTIONAL,INTENT(IN)::pl2ix(:)
COMPLEX(DP),DEVICE::r_d(ldx,ldy,nzl),temp_d(ldy,nzl,ldx)
INTEGER::i,k,j,err,idir,ip,kk,void,istat
REAL(DP)::tscale
INTEGER,SAVE::icurrent=1
INTEGER,SAVE::dims(6,ndims)=-1
LOGICAL::dofft(nfftx),found
INTEGER,PARAMETER::stdout=6
REAL(DP),SAVE::xyflops(ndims)=0.d0
INTEGER,SAVE::cufft_plan_2d(ndims)=0
INTEGER,SAVE::cufft_plan_x(ndims)=0
INTEGER,SAVE::cufft_plan_y(2,ndims)=0
INTEGER::batch_1,batch_2
INTEGER,PARAMETER::RANK=2
INTEGER::FFT_DIM(RANK),DATA_DIM(RANK)
INTEGER::STRIDE,DIST,BATCH
INTEGER,PARAMETER::RANK=1
INTEGER::FFT_DIM_X(RANK),DATA_DIM_X(RANK),FFT_DIM_Y(RANK),DATA_DIM_Y(RANK)
INTEGER::STRIDE_X,STRIDE_Y,DIST_X,DIST_Y,BATCH_X,BATCH_Y1,BATCH_Y2
INTEGER,INTENT(IN)::nx,ny,nz,ldx,ldy,ldz,howmany,isign
COMPLEX(DP),device::f_d(:)
INTEGER(kind=cuda_stream_kind)::stream
INTEGER::i,k,j,err,idir,ip,istat
REAL(DP)::tscale
INTEGER,SAVE::icurrent=1
INTEGER,SAVE::dims(4,ndims)=-1
INTEGER,SAVE::cufft_plan_3d(ndims)=0
INTEGER,PARAMETER::RANK=3
INTEGER::FFT_DIM(RANK),DATA_DIM(RANK)
INTEGER::STRIDE,DIST,BATCH
INTEGER,PARAMETER::stdout=6
integer::nx,ny,nz,ldx,ldy,ldz,howmany,isign
complex(DP),device::f_d(ldx*ldy*ldz)
integer::do_fft_y(:),do_fft_z(:)
integer(kind=cuda_stream_kind)::stream
integer::m,incx1,incx2
INTEGER::i,k,j,err,idir,ip,ii,jj,istat
REAL(DP)::tscale
INTEGER,SAVE::icurrent=1
INTEGER,SAVE::dims(3,ndims)=-1
INTEGER,SAVE::cufft_plan_1d(3,ndims)=0
INTEGER,PARAMETER::RANK=3
INTEGER::FFT_DIM(RANK),HOW_MANY(RANK),DATA_DIM(RANK)
INTEGER::STRIDE(RANK),DIST(RANK)
INTEGER::i
INTEGER,PARAMETER::DP=selected_real_kind(14,200)
INTEGER,PARAMETER::ndims=3
INTEGER::cft_b_dims(3)
TYPE(C_PTR)::cft_b_bw_planz=C_NULL_PTR
TYPE(C_PTR)::cft_b_bw_planx=C_NULL_PTR
TYPE(C_PTR)::cft_b_bw_plany=C_NULL_PTR
complex(dp)::f(:)
real(DP)::tscale
integer::ip,i,first_index,how_many_y
integer,save::icurrent=1
integer,save::dims(3,ndims)=-1
TYPE(C_PTR),save::bw_planz(ndims)=C_NULL_PTR
TYPE(C_PTR),save::bw_planx(ndims)=C_NULL_PTR
TYPE(C_PTR),save::bw_plany(ndims)=C_NULL_PTR
integer,INTENT(IN)::nx,ny,nz
integer,INTENT(IN)::nx,ny,nz,ldx,ldy,ldz,imin2,imax2,imin3,imax3,sgn
complex(dp)::f(:)
INTEGER,SAVE::k,first_index,how_many_y
INTEGER::stdout=6
INTEGER,ALLOCATABLE::irb(:,:)
INTEGER,ALLOCATABLE::imin2(:),imin3(:)
INTEGER,ALLOCATABLE::imax2(:),imax3(:)
INTEGER,ALLOCATABLE::np2(:),np3(:)
INTEGER::nr1=0!
INTEGER::nr2=0
INTEGER::nr3=0!
INTEGER::nr1x=0
INTEGER::nr2x=0
INTEGER::nr3x=0
INTEGER::nnr=0
INTEGER::mype=0
INTEGER::comm=0
INTEGER::nproc=1
INTEGER::root=0
TYPE(fft_box_descriptor)::desc
INTEGER,INTENT(in)::nat,nproc,mype,root,comm
TYPE(fft_box_descriptor)::desc
TYPE(fft_box_descriptor),INTENT(INOUT)::desc
INTEGER,INTENT(in)::nat
INTEGER,INTENT(in)::irb(:,:)
TYPE(fft_type_descriptor),INTENT(IN)::dfftp
INTEGER::nr1b,nr2b,nr3b,nr1bx,nr2bx,nr3bx
INTEGER::isa
INTEGER::ir2,ibig2,irb2,imin2,imax2,nr2
INTEGER::ir3,ibig3,irb3,imin3,imax3,nr3
INTEGER::n,nx
REAL(DP)::log2n
integer::nr
logical::allowed
integer::pwr(5)
integer::mr,i,fac,p,maxpwr
integer::factors(5)=(/2,3,5,7,11/)
INTEGER,INTENT(IN)::nr
INTEGER,OPTIONAL,INTENT(IN)::np
INTEGER::new
INTEGER::nr1=0!
INTEGER::nr2=0
INTEGER::nr3=0!
INTEGER::nr1x=0
INTEGER::nr2x=0
INTEGER::nr3x=0
LOGICAL::lpara=.FALSE.
LOGICAL::lgamma=.FALSE.
INTEGER::root=0
INTEGER::comm=MPI_COMM_NULL
INTEGER::comm2=MPI_COMM_NULL
INTEGER::comm3=MPI_COMM_NULL
INTEGER::nproc=1
INTEGER::nproc2=1
INTEGER::nproc3=1
INTEGER::mype=0
INTEGER::mype2=0
INTEGER::mype3=0
INTEGER,ALLOCATABLE::iproc(:,:),iproc2(:),iproc3(:)
INTEGER::my_nr3p=0
INTEGER::my_nr2p=0
INTEGER::my_i0r3p=0
INTEGER::my_i0r2p=0
INTEGER,ALLOCATABLE::nr3p(:)
INTEGER,ALLOCATABLE::nr3p_offset(:)
INTEGER,ALLOCATABLE::nr2p(:)
INTEGER,ALLOCATABLE::nr2p_offset(:)
INTEGER,ALLOCATABLE::nr1p(:)
INTEGER,ALLOCATABLE::nr1w(:)
INTEGER::nr1w_tg
INTEGER,ALLOCATABLE::i0r3p(:)
INTEGER,ALLOCATABLE::i0r2p(:)
INTEGER,ALLOCATABLE::ir1p(:)
INTEGER,ALLOCATABLE::indp(:,:)
INTEGER,ALLOCATABLE::ir1w(:)
INTEGER,ALLOCATABLE::indw(:,:)
INTEGER,ALLOCATABLE::ir1w_tg(:)
INTEGER,ALLOCATABLE::indw_tg(:)
INTEGER::nst
INTEGER,ALLOCATABLE::nsp(:)
INTEGER,ALLOCATABLE::nsp_offset(:,:)
INTEGER,ALLOCATABLE::nsw(:)
INTEGER,ALLOCATABLE::nsw_offset(:,:)
INTEGER,ALLOCATABLE::nsw_tg(:)
INTEGER,ALLOCATABLE::ngl(:)
INTEGER,ALLOCATABLE::nwl(:)
INTEGER::ngm
INTEGER::ngw
INTEGER,ALLOCATABLE::iplp(:)
INTEGER,ALLOCATABLE::iplw(:)
INTEGER::nnp=0
INTEGER::nnr=0
INTEGER::nnr_tg=0
INTEGER,ALLOCATABLE::iss(:)
INTEGER,ALLOCATABLE::isind(:)
INTEGER,ALLOCATABLE::ismap(:)
INTEGER,ALLOCATABLE::nl(:)
INTEGER,ALLOCATABLE::nlm(:)
INTEGER,ALLOCATABLE::tg_snd(:)
INTEGER,ALLOCATABLE::tg_rcv(:)
INTEGER,ALLOCATABLE::tg_sdsp(:)
INTEGER,ALLOCATABLE::tg_rdsp(:)
LOGICAL::has_task_groups=.FALSE.
LOGICAL::use_pencil_decomposition=.FALSE.
CHARACTER(len=12)::rho_clock_label=''
CHARACTER(len=12)::wave_clock_label=''
INTEGER::grid_id
INTEGER(kind=cuda_stream_kind),allocatable,dimension(:)::stream_scatter_yz
INTEGER(kind=cuda_stream_kind),allocatable,dimension(:)::stream_many
INTEGER::nstream_many=16
INTEGER(kind=cuda_stream_kind)::a2a_comp
INTEGER(kind=cuda_stream_kind),allocatable,dimension(:)::bstreams
TYPE(cudaEvent),allocatable,dimension(:)::bevents
INTEGER::batchsize=16
INTEGER::subbatchsize=4
INTEGER::IPC_PEER(16)
INTEGER,ALLOCATABLE::srh(:,:)
REAL(DP)::fft_dual=4.0d0
INTEGER::incremental_grid_identifier=0
TYPE(fft_type_descriptor)::desc
REAL(DP),INTENT(IN)::at(3,3),bg(3,3)
REAL(DP),INTENT(IN)::gcutm
INTEGER,INTENT(IN),OPTIONAL::fft_fact(3)
INTEGER,INTENT(IN),OPTIONAL::nyfft
INTEGER,INTENT(in)::comm
INTEGER::nx,ny,ierr,imany,nzfft
INTEGER::i,nsubbatches
INTEGER::mype,root,nproc,nproc2,nproc3,iproc,iproc2,iproc3
INTEGER::color,key,comm2,comm3
TYPE(fft_type_descriptor)::desc
INTEGER::iproc,ierr,imany
INTEGER::i,nsubbatches
TYPE(fft_type_descriptor)::desc
INTEGER,INTENT(in)::nst
INTEGER,INTENT(in)::ub(3),lb(3)
INTEGER,INTENT(in)::idx(:)
INTEGER,INTENT(in)::in1(:)
INTEGER,INTENT(in)::in2(:)
INTEGER,INTENT(in)::ncp(:)
INTEGER,INTENT(in)::ncpw(:)
INTEGER,INTENT(in)::ngp(:)
INTEGER,INTENT(in)::ngpw(:)
INTEGER,INTENT(in)::st(lb(1):ub(1),lb(2):ub(2))
INTEGER,INTENT(in)::stw(lb(1):ub(1),lb(2):ub(2))
INTEGER::nsp(desc%nproc),nsw_tg,nr1w_tg
INTEGER::np,nq,i,is,iss,itg,i1,i2,m1,m2,ip
INTEGER::ncpx,nr1px,nr2px,nr3px
INTEGER::nr1,nr2,nr3
INTEGER::nr1x,nr2x,nr3x
TYPE(fft_type_descriptor),INTENT(INOUT)::dfft
TYPE(sticks_map),INTENT(INOUT)::smap
CHARACTER(LEN=*),INTENT(IN)::pers
LOGICAL,INTENT(IN)::lpara
LOGICAL,INTENT(IN)::lgamma
INTEGER,INTENT(IN)::comm
REAL(DP),INTENT(IN)::gcut_in
REAL(DP),INTENT(IN)::bg(3,3)
REAL(DP),INTENT(IN)::at(3,3)
REAL(DP),OPTIONAL,INTENT(IN)::dual_in
INTEGER,INTENT(IN),OPTIONAL::fft_fact(3)
INTEGER,INTENT(IN)::nyfft
LOGICAL,OPTIONAL,INTENT(IN)::use_pd
INTEGER,ALLOCATABLE::st(:,:)
INTEGER,ALLOCATABLE::nstp(:)
INTEGER,ALLOCATABLE::sstp(:)
INTEGER::nst
INTEGER,ALLOCATABLE::stw(:,:)
INTEGER,ALLOCATABLE::nstpw(:)
INTEGER,ALLOCATABLE::sstpw(:)
INTEGER::nstw
REAL(DP)::gcut,gkcut,dual
INTEGER::ngm,ngw
REAL(DP),INTENT(IN)::at(3,3),bg(3,3)
REAL(DP),INTENT(IN)::gcutm
INTEGER,INTENT(IN),OPTIONAL::fft_fact(3)
TYPE(fft_type_descriptor),INTENT(INOUT)::dfft
TYPE(fft_type_descriptor),INTENT(IN)::dfft
INTEGER,INTENT(INOUT)::nr1,nr2,nr3
REAL(DP),INTENT(IN)::bg(3,3),gcut
INTEGER::i,j,k,nr,nb(3)
REAL(DP)::gsq,g(3)
TYPE(fft_type_descriptor),INTENT(IN)::desc
INTEGER::fft_stick_index
INTEGER,INTENT(IN)::i,j
INTEGER::mc,m1,m2
TYPE(C_PTR)::plan
INTEGER(KIND=C_INT)::nz,i
TYPE(C_PTR)::plan
TYPE(C_PTR)::plan
INTEGER(KIND=C_INT)::nx,ny,i
TYPE(C_PTR)::plan
TYPE(C_PTR)::plan
INTEGER(KIND=C_INT)::nx,ny,nz,i
TYPE(C_PTR)::plan
TYPE(C_PTR)::plan
INTEGER(KIND=C_INT)::nx,ny,nz,ldx,ldy
COMPLEX(KIND=C_DOUBLE)::xy
TYPE(C_PTR)::plan
INTEGER(KIND=C_INT)::nx,ny,nz,ldx,ldy
COMPLEX(KIND=C_DOUBLE)::xy
TYPE(C_PTR)::plan
INTEGER(KIND=C_INT)::ny,ldx
COMPLEX(KIND=C_DOUBLE)::xy
TYPE(C_PTR)::plan
INTEGER(KIND=C_INT)::ldz,nzl
COMPLEX(KIND=C_DOUBLE)::z
TYPE(C_PTR)::plan
INTEGER(KIND=C_INT)::ldz
COMPLEX(KIND=C_DOUBLE)::z
TYPE(C_PTR)::plan
INTEGER(KIND=C_INT)::m,inc1,inc2
COMPLEX(KIND=C_DOUBLE)::z
TYPE(C_PTR)::plan
INTEGER(KIND=C_INT)::m,inc1,inc2
COMPLEX(KIND=C_DOUBLE)::z
#integer,character(len=256),integer(C_INT16_T)::version=1
integer(C_INT16_T)::size=48!
integer(C_INT)::category=0
integer(C_INT)::colorType=1
integer(C_INT)::color
integer(C_INT)::payloadType=0
integer(C_INT)::reserved0
integer(C_INT64_T)::payload
integer(C_INT)::messageType=1
type(C_PTR)::message
character(kind=C_CHAR,len=*)::name
character(kind=c_char,len=*)::name
integer,optional::id
integer::istat
character(kind=c_char,len=*)::name
integer,optional::id
integer::istat
TYPE(fft_type_descriptor),INTENT(in)::desc
INTEGER,INTENT(in)::nxx_,isgn
COMPLEX(DP),INTENT(inout)::f_in(nxx_),f_aux(nxx_)
INTEGER::nr1_temp(1)
INTEGER,INTENT(in)::nr2px,nproc2,my_nr2p
INTEGER,INTENT(in)::nr1p_(nproc2),indx(desc%nr1x,nproc2),iplx(desc%nr1x)
INTEGER::ierr,me2,iproc2,ncpx
INTEGER::i,it,j,k,kfrom,kdest,mc,m1,m3,i1,icompact,sendsize
INTEGER::sh(desc%nproc2),rh(desc%nproc2)
TYPE(fft_type_descriptor),INTENT(in)::desc
INTEGER,INTENT(in)::nxx_,isgn
COMPLEX(DP),INTENT(inout)::f_in(nxx_),f_aux(nxx_)
INTEGER,INTENT(in)::me2_start,me2_end
INTEGER,INTENT(in)::ncp_(desc%nproc),ir1p_(desc%nr1x),me2_iproc3_offset(desc%nproc2,desc%nproc3)
INTEGER::ierr,me2,me3,nproc3,iproc3,ncpx,nr3px,ip
INTEGER::i,it,k,kfrom,kdest,mc,m1,m2,i1,sendsize
INTEGER::my_nr1p_
INTEGER::sh(desc%nproc3),rh(desc%nproc3)
TYPE(fft_type_descriptor),INTENT(in)::desc
INTEGER,INTENT(in)::nxx_,isgn
COMPLEX(DP),INTENT(inout)::f_in(nxx_),f_aux(nxx_)
INTEGER::ierr
TYPE(fft_type_descriptor),INTENT(in)::desc
INTEGER,INTENT(in)::nxx_,isgn
COMPLEX(DP),INTENT(inout)::f_in(nxx_),f_out(nxx_)
INTEGER::ierr
REAL(DP),INTENT(in)::f_in(:)
REAL(DP),INTENT(inout)::f_out(:)
TYPE(fft_type_descriptor),INTENT(IN)::dfft
INTEGER::proc,info,offset_in,offset_aux,ir3
INTEGER::displs(0:dfft%nproc-1),recvcount(0:dfft%nproc-1)
REAL(DP),ALLOCATABLE::f_aux(:)
COMPLEX(DP),INTENT(in)::f_in(:)
COMPLEX(DP),INTENT(inout)::f_out(:)
TYPE(fft_type_descriptor),INTENT(IN)::dfft
COMPLEX(DP),ALLOCATABLE::f_aux(:)
INTEGER::proc,info,offset_in,offset_aux,ir3
INTEGER::displs(0:dfft%nproc-1),recvcount(0:dfft%nproc-1)
REAL(DP),INTENT(in)::f_in(:)
REAL(DP),INTENT(inout)::f_out(:)
TYPE(fft_type_descriptor),INTENT(IN)::dfft
REAL(DP),ALLOCATABLE::f_aux(:)
INTEGER::proc,info,offset_in,offset_aux,ir3
INTEGER::displs(0:dfft%nproc-1),sendcount(0:dfft%nproc-1)
COMPLEX(DP),INTENT(in)::f_in(:)
COMPLEX(DP),INTENT(inout)::f_out(:)
TYPE(fft_type_descriptor),INTENT(IN)::dfft
COMPLEX(DP),ALLOCATABLE::f_aux(:)
INTEGER::proc,info,offset_in,offset_aux,ir3
INTEGER::displs(0:dfft%nproc-1),sendcount(0:dfft%nproc-1)
TYPE(fft_type_descriptor),INTENT(in)::dfftp
COMPLEX(DP)::f_in(:),f_out(:)
COMPLEX(DP),ALLOCATABLE::f_aux(:)
INTEGER::proc,info,offset_in,offset_aux,ir3
INTEGER::displs(0:dfftp%nproc-1),recvcount(0:dfftp%nproc-1)
TYPE(fft_type_descriptor),INTENT(in)::dfftp
INTEGER::nbnd,nbnd_proc(dfftp%nproc),start_nbnd_proc(dfftp%nproc)
COMPLEX(DP)::f_in(dfftp%nnr,nbnd)
COMPLEX(DP)::f_out(dfftp%nr1x*dfftp%nr2x*dfftp%nr3x,nbnd_proc(dfftp%mype+1))
COMPLEX(DP),ALLOCATABLE::f_aux(:)
INTEGER::proc_,proc2_,proc3_,proc,info,offset_in,offset_aux,ir3,nr2px
INTEGER::ibnd,jbnd,iii
INTEGER::displs(0:dfftp%nproc-1),recvcount(0:dfftp%nproc-1)
TYPE(fft_type_descriptor),INTENT(in)::dfftp
INTEGER::nbnd,nbnd_proc(dfftp%nproc),start_nbnd_proc(dfftp%nproc)
COMPLEX(DP)::f_in(dfftp%nr1x*dfftp%nr2x*dfftp%nr3x,nbnd_proc(dfftp%mype+1))
COMPLEX(DP)::f_out(dfftp%nnr)
COMPLEX(DP),ALLOCATABLE::f_aux(:)
INTEGER::target_ibnd
INTEGER::proc_,proc2_,proc3_,proc,info,offset_out,offset_aux,ir3
INTEGER::displs(0:dfftp%nproc-1),sendcount(0:dfftp%nproc-1)
INTEGER::ibnd,jbnd
integer::n
integer::ia(2,n)
integer::i,ir,j,l
integer::iia(2)
TYPE(fft_type_descriptor),INTENT(in)::dfft
INTEGER,INTENT(in)::nr3x,nxx_,isgn,ncp_(:),npp_(:)
COMPLEX(DP),INTENT(inout)::f_in(nxx_),f_aux(nxx_)
INTEGER::k,offset,proc,ierr,me,nprocp,gproc,i,kdest,kfrom
INTEGER::me_p,nppx,mc,j,npp,nnp,ii,it,ip,ioff,sendsiz,ncpx,ipp,nsiz
TYPE(fft_type_descriptor),TARGET,INTENT(in)::dfft
INTEGER,INTENT(in)::nr3x,nxx_,isgn,ncp_(:),npp_(:)
COMPLEX(DP),DEVICE,INTENT(inout)::f_in_d(nxx_),f_aux_d(nxx_)
COMPLEX(DP),INTENT(inout)::f_in(nxx_),f_aux(nxx_)
INTEGER::cuf_i,cuf_j,nswip
INTEGER::istat
INTEGER,POINTER,DEVICE::p_ismap_d(:)
INTEGER::srh(2*dfft%nproc)
INTEGER::k,offset,proc,ierr,me,nprocp,gproc,gcomm,i,kdest,kfrom
INTEGER::me_p,nppx,mc,j,npp,nnp,ii,it,ip,ioff,sendsiz,ncpx,ipp,nblk,nsiz
INTEGER::iter,dest,sorc
INTEGER::istatus(MPI_STATUS_SIZE)
TYPE(fft_type_descriptor),TARGET,INTENT(in)::dfft
INTEGER,INTENT(in)::nr3x,nxx_,isgn,ncp_(:),npp_(:)
COMPLEX(DP),DEVICE,INTENT(inout)::f_in_d(batchsize*nxx_),f_aux_d(batchsize*nxx_)
COMPLEX(DP),INTENT(inout)::f_in(batchsize*nxx_),f_aux(batchsize*nxx_)
INTEGER,INTENT(IN)::batchsize
INTEGER,INTENT(INOUT)::srh(2*dfft%nproc)
INTEGER::cuf_i,cuf_j,nswip
INTEGER::istat
INTEGER,POINTER,DEVICE::p_ismap_d(:)
INTEGER::k,offset,proc,ierr,me,nprocp,gproc,gcomm,i,kdest,kfrom
INTEGER::me_p,nppx,mc,j,npp,nnp,nnr,ii,it,ip,ioff,sendsiz,ncpx,ipp,nblk,nsiz
INTEGER::iter,dest,sorc
INTEGER::istatus(MPI_STATUS_SIZE)
TYPE(fft_type_descriptor),TARGET,INTENT(in)::dfft
INTEGER,INTENT(in)::nr3x,nxx_,isgn,ncp_(:),npp_(:)
COMPLEX(DP),DEVICE,INTENT(inout)::f_in_d(batchsize*nxx_),f_aux_d(batchsize*nxx_),f_aux2_d(batchsize*nxx_)
COMPLEX(DP),INTENT(inout)::f_in(batchsize*nxx_),f_aux(batchsize*nxx_),f_aux2(batchsize*nxx_)
INTEGER,INTENT(IN)::batchsize,batch_id
INTEGER::istat
INTEGER,POINTER,DEVICE::p_ismap_d(:)
INTEGER::k,offset,proc,ierr,me,nprocp,gproc,gcomm,i,kdest,kfrom
INTEGER::me_p,nppx,mc,j,npp,nnp,nnr,ii,it,ip,ioff,sendsiz,ncpx,ipp,nblk,nsiz
INTEGER,ALLOCATABLE,DIMENSION(:)::offset_proc
INTEGER::iter,dest,sorc
INTEGER::istatus(MPI_STATUS_SIZE)
TYPE(fft_type_descriptor),TARGET,INTENT(in)::dfft
INTEGER,INTENT(in)::nr3x,nxx_,isgn,ncp_(:),npp_(:)
COMPLEX(DP),DEVICE,INTENT(inout)::f_in_d(batchsize*nxx_),f_aux_d(batchsize*nxx_),f_aux2_d(batchsize*nxx_)
COMPLEX(DP),INTENT(inout)::f_in(batchsize*nxx_),f_aux(batchsize*nxx_),f_aux2(batchsize*nxx_)
INTEGER,INTENT(IN)::batchsize,batch_id
INTEGER::cuf_i,cuf_j,nswip
INTEGER::istat
INTEGER,POINTER,DEVICE::p_ismap_d(:)
INTEGER::k,offset,proc,ierr,me,nprocp,gproc,gcomm,i,kdest,kfrom
INTEGER::me_p,nppx,mc,j,npp,nnp,nnr,ii,it,ip,ioff,sendsiz,ncpx,ipp,nblk,nsiz
INTEGER::iter,dest,sorc,req_cnt
INTEGER::istatus(MPI_STATUS_SIZE)
TYPE(fft_type_descriptor),TARGET,INTENT(in)::dfft
INTEGER,INTENT(in)::nr3x,nxx_,isgn,ncp_(:),npp_(:)
COMPLEX(DP),DEVICE,INTENT(inout)::f_in_d(batchsize*nxx_),f_aux_d(batchsize*nxx_),f_aux2_d(batchsize*nxx_)
COMPLEX(DP),INTENT(inout)::f_in(batchsize*nxx_),f_aux(batchsize*nxx_),f_aux2(batchsize*nxx_)
INTEGER,INTENT(IN)::batchsize,batch_id
INTEGER::cuf_i,cuf_j,nswip
INTEGER::istat
INTEGER,POINTER,DEVICE::p_ismap_d(:)
INTEGER::k,offset,proc,ierr,me,nprocp,gproc,gcomm,i,kdest,kfrom
INTEGER::me_p,nppx,mc,j,npp,nnp,nnr,ii,it,ip,ioff,sendsiz,ncpx,ipp,nblk,nsiz
LOGICAL::use_tg
INTEGER::iter,dest,sorc
INTEGER::istatus(MPI_STATUS_SIZE)
TYPE(fft_type_descriptor),TARGET,INTENT(in)::dfft
INTEGER,INTENT(in)::nr3x,nxx_,isgn,ncp_(:),npp_(:)
COMPLEX(DP),DEVICE,INTENT(inout)::f_in_d(batchsize*nxx_),f_aux_d(batchsize*nxx_),f_aux2_d(batchsize*nxx_)
COMPLEX(DP),INTENT(inout)::f_in(batchsize*nxx_),f_aux(batchsize*nxx_),f_aux2(batchsize*nxx_)
INTEGER,INTENT(IN)::batchsize,batch_id
INTEGER::istat
INTEGER,POINTER,DEVICE::p_ismap_d(:)
INTEGER::k,offset,proc,ierr,me,nprocp,gproc,gcomm,i,kdest,kfrom
INTEGER::me_p,nppx,mc,j,npp,nnp,nnr,ii,it,ip,ioff,sendsiz,ncpx,ipp,nblk,nsiz
INTEGER::iter,dest,sorc,req_cnt
INTEGER::istatus(MPI_STATUS_SIZE)
TYPE(fft_type_descriptor),INTENT(in)::desc
INTEGER,INTENT(in)::nxx_,isgn
COMPLEX(DP),DEVICE,INTENT(inout)::f_in_d(nxx_),f_aux_d(nxx_)
INTEGER(kind=cuda_stream_kind),INTENT(IN)::stream
INTEGER::ierr,me2,nproc2,iproc2,ncpx,nr1x,my_nr2p,nr2px,ip,ip0
INTEGER::i,it,j,k,kfrom,kdest,offset,ioff,mc,m1,m3,i1,icompact,sendsize,aux
INTEGER,ALLOCATABLE::ncp_(:)
INTEGER,POINTER,DEVICE::nr1p__d(:),indx_d(:,:)
INTEGER::sh(desc%nproc2),rh(desc%nproc2)
TYPE(fft_type_descriptor),INTENT(in)::desc
INTEGER,INTENT(in)::nxx_,isgn
COMPLEX(DP),DEVICE,INTENT(inout)::f_in_d(nxx_),f_aux_d(nxx_)
INTEGER,DEVICE,POINTER::desc_ismap_d(:)
INTEGER::ierr,me,me2,me2_start,me2_end,me3,nproc3,iproc3,ncpx,nr3px,ip,ip0
INTEGER::nr1x,nr2x,nr3,nr3x
INTEGER::i,it,it0,k,kfrom,kdest,offset,ioff,mc,m1,m2,i1,sendsize,aux
INTEGER,ALLOCATABLE::ncp_(:)
INTEGER,DEVICE,POINTER::ir1p__d(:)
INTEGER::my_nr1p_
INTEGER::sh(desc%nproc3),rh(desc%nproc3)
TYPE(cudaEvent)::zero_event
TYPE(fft_type_descriptor),INTENT(in)::desc
INTEGER,INTENT(in)::nxx_,isgn
COMPLEX(DP),DEVICE,INTENT(inout)::f_in_d(nxx_),f_aux_d(nxx_)
INTEGER(kind=cuda_stream_kind),INTENT(IN)::stream
INTEGER::ierr
TYPE(fft_type_descriptor),INTENT(in)::desc
INTEGER,INTENT(in)::nxx_,isgn
COMPLEX(DP),DEVICE,INTENT(inout)::f_in_d(nxx_),f_out_d(nxx_)
INTEGER(kind=cuda_stream_kind),INTENT(IN)::stream
INTEGER::ierr
TYPE(fft_type_descriptor),INTENT(in)::desc
INTEGER,INTENT(in)::nxx_,isgn
COMPLEX(DP),DEVICE,INTENT(inout)::f_in_d(nxx_),f_aux_d(nxx_)
INTEGER,INTENT(IN)::howmany
INTEGER,DEVICE,POINTER::desc_ismap_d(:)
INTEGER::ierr,me,me2,me3,nproc3,iproc3,ncpx,nr3px,ip,ip0,me2_start,me2_end
INTEGER::nr1x,nr2x,nr3,nr3x,nnr
INTEGER::i,j,it,it0,k,kfrom,kdest,offset,ioff,mc,m1,m2,i1,sendsize,aux
INTEGER,ALLOCATABLE::ncp_(:)
INTEGER,DEVICE,POINTER::ir1p__d(:)
INTEGER::my_nr1p_
INTEGER::sh(desc%nproc3),rh(desc%nproc3)
LOGICAL::lgamma=.false.
LOGICAL::lpara=.false.
INTEGER::mype=0
INTEGER::nproc=1
INTEGER::nyfft=1
INTEGER,ALLOCATABLE::iproc(:,:)
INTEGER,ALLOCATABLE::iproc2(:)
INTEGER::comm=MPI_COMM_NULL
INTEGER::comm=0
INTEGER::nstx=0
INTEGER::lb(3)=0
INTEGER::ub(3)=0
INTEGER,ALLOCATABLE::idx(:)
INTEGER,ALLOCATABLE::ist(:,:)
INTEGER,ALLOCATABLE::stown(:,:)
INTEGER,ALLOCATABLE::indmap(:,:)
REAL(DP)::bg(3,3)
TYPE(sticks_map)::smap
TYPE(sticks_map)::smap
LOGICAL,INTENT(IN)::lgamma
LOGICAL,INTENT(IN)::lpara
INTEGER,INTENT(IN)::nyfft
INTEGER,INTENT(IN)::iproc(:,:)
INTEGER,INTENT(IN)::iproc2(:)
INTEGER,INTENT(IN)::nr1,nr2,nr3
INTEGER,INTENT(IN)::comm
REAL(DP),INTENT(IN)::bg(3,3)
INTEGER::lb(3),ub(3)
INTEGER::nzfft,nstx,ierr
INTEGER,ALLOCATABLE::indmap(:,:),stown(:,:),idx(:),ist(:,:)
LOGICAL,INTENT(in)::lgamma
INTEGER,INTENT(in)::ub(:)
INTEGER,INTENT(in)::lb(:)
REAL(DP),INTENT(in)::bg(:,:)
REAL(DP),INTENT(in)::gcut
INTEGER,OPTIONAL,INTENT(in)::comm
INTEGER,INTENT(out)::st(lb(1):ub(1),lb(2):ub(2))
REAL(DP)::b1(3),b2(3),b3(3)
INTEGER::i1,i2,i3,n1,n2,n3,mype,nproc,ierr
REAL(DP)::amod
INTEGER::ngm
INTEGER,INTENT(in)::ub(:),lb(:)
INTEGER,INTENT(in)::st(lb(1):ub(1),lb(2):ub(2))
INTEGER,INTENT(inout)::index_map(lb(1):ub(1),lb(2):ub(2))
INTEGER,INTENT(out)::in1(:),in2(:)
INTEGER,INTENT(out)::ngc(:)
INTEGER::j1,j2,i1,i2,i3,nct,min_size,ind
LOGICAL::ok
LOGICAL,INTENT(in)::parallel
INTEGER,INTENT(in)::ng(:)
INTEGER,INTENT(in)::nct
INTEGER,INTENT(inout)::idx(:)
INTEGER::mc,ic,nc
INTEGER,ALLOCATABLE::iaux(:)
INTEGER,ALLOCATABLE::itmp(:)
REAL(DP),ALLOCATABLE::aux(:)
LOGICAL,INTENT(in)::lgamma
INTEGER,INTENT(in)::mype
INTEGER,INTENT(in)::nproc
INTEGER,INTENT(in)::nyfft
INTEGER,INTENT(in)::iproc(:,:),iproc2(:)
INTEGER,INTENT(in)::ub(:),lb(:),idx(:)
INTEGER,INTENT(inout)::stown(lb(1):ub(1),lb(2):ub(2))
INTEGER,INTENT(in)::in1(:),in2(:)
INTEGER,INTENT(in)::ngc(:)
INTEGER,INTENT(in)::nct
INTEGER,INTENT(out)::ncp(:)
INTEGER,INTENT(out)::ngp(:)
INTEGER,INTENT(out)::ng
INTEGER::mc,i1,i2,j,jj,icnt,gr,j2,j3
INTEGER,ALLOCATABLE::yc(:),yg(:)
INTEGER,ALLOCATABLE::ygr(:)
INTEGER,ALLOCATABLE::ygrp(:),ygrc(:),ygrg(:)
TYPE(sticks_map),INTENT(INOUT)::smap
REAL(DP),INTENT(in)::gcut
INTEGER,INTENT(out)::st(smap%lb(1):smap%ub(1),smap%lb(2):smap%ub(2))
INTEGER,INTENT(out)::nstp(:)
INTEGER,INTENT(out)::sstp(:)
INTEGER,INTENT(out)::nst
INTEGER,INTENT(out)::ng
INTEGER,ALLOCATABLE::ngc(:)
INTEGER::ic
INTEGER::n
INTEGER::ind(n)
REAL(DP)::ra(n)
INTEGER::i,ir,j,l,iind
REAL(DP)::rra
LOGICAL::ignore_time=.true.
REAL*8::times(20)=0.d0
TYPE(fft_type_descriptor)::dfftp,dffts,dfft3d
TYPE(sticks_map)::smap
INTEGER::nx=128
INTEGER::ny=128
INTEGER::nz=256
INTEGER::mype,npes,comm,root
INTEGER::ntgs
INTEGER::nbnd
LOGICAL::iope
INTEGER::ierr,i,j,ncount,ib
INTEGER::incr=1,right_nr3
INTEGER::ngw_,ngm_,ngs_
REAL*8::gcutm,gkcut,gcutms
REAL*8::ecutm,ecutw,ecutms
REAL*8::ecutrho,dual,kmax(3)
REAL*8::ecutwfc
REAL*8::tpiba,alat,alat_in
REAL*8::time(100)
REAL*8::my_time(100)
REAL*8::time_min(100)
REAL*8::time_max(100)
REAL*8::time_avg(100)
REAL*8::wall
REAL*8::wall_avg
LOGICAL::gamma_only=.false.
LOGICAL::use_tg
REAL*8::at(3,3),bg(3,3)
REAL(DP),PARAMETER::pi=3.14159265358979323846_DP
COMPLEX(DP),ALLOCATABLE::tg_psic(:)
COMPLEX(DP),ALLOCATABLE::psic(:)
COMPLEX(DP),ALLOCATABLE::psi(:,:)
REAL(DP),ALLOCATABLE::v(:)
REAL(DP),ALLOCATABLE::tg_v(:)
COMPLEX(DP),ALLOCATABLE::hpsi(:,:)
INTEGER::ngms,ngsx,ngms_g
INTEGER,ALLOCATABLE::mill(:,:),ig_l2g(:)
REAL(DP),ALLOCATABLE::g(:,:),gg(:)
INTEGER::ngm,ngmx,ngm_g,gstart
integer::nargs
CHARACTER(LEN=80)::arg
INTEGER::PROVIDED
real(DP)::a1(3),a2(3),a3(3),b1(3),b2(3),b3(3)
real(DP)::den,s
integer::iperm,i,j,k,l,ipol
TYPE(fft_type_descriptor),INTENT(INOUT)::dfftp
LOGICAL,INTENT(IN)::gamma_only
REAL(DP),INTENT(IN)::at(3,3),bg(3,3),gcutm
INTEGER,INTENT(IN)::ngm_g
INTEGER,INTENT(INOUT)::ngm
REAL(DP),INTENT(OUT)::g(:,:),gg(:)
INTEGER,INTENT(OUT)::mill(:,:),ig_l2g(:),gstart
LOGICAL,INTENT(IN)::no_global_sort
REAL(DP)::tx(3),ty(3),t(3)
REAL(DP),ALLOCATABLE::tt(:)
INTEGER::ngm_save,n1,n2,n3,ngm_offset,ngm_max,ngm_local
REAL(DP),ALLOCATABLE::g2sort_g(:)
INTEGER,ALLOCATABLE::mill_unsorted(:,:)
INTEGER,ALLOCATABLE::igsrt(:),g2l(:)
INTEGER::ni,nj,nk,i,j,k,ipol,ng,igl,indsw,ierr
INTEGER::istart,jstart,kstart
INTEGER::mype,npe
LOGICAL::global_sort,is_local
INTEGER,ALLOCATABLE::ngmpe(:)
LOGICAL,INTENT(IN)::gamma_only
TYPE(fft_type_descriptor),INTENT(INOUT)::dffts
REAL(dp),INTENT(IN)::at(3,3)
REAL(dp),INTENT(IN)::g(:,:),gg(:)
INTEGER,INTENT(IN)::mill(:,:)
REAL(DP),INTENT(IN)::gcutms
INTEGER,INTENT(OUT)::ngms
REAL(DP),INTENT(OUT),POINTER,OPTIONAL::gs(:,:),ggs(:)
INTEGER::i,ng,ngm
LOGICAL,INTENT(IN)::ionode
TYPE(fft_type_descriptor),INTENT(IN)::dfftp,dffts
character(len=*)::label
character(len=*)::label
integer,intent(in)::mype,npes,ncount
REAL*8::time_min(20)
REAL*8::time_max(20)
REAL*8::time_avg(20)
integer::ierr
integer,intent(in)::n
integer,intent(inout)::ind(*)
real(DP),intent(inout)::ra(*)
real(DP),intent(in)::eps
integer::i,ir,j,l,iind
real(DP)::rra
integer,intent(in)::ibnd,nbnd,ngms
TYPE(fft_type_descriptor),intent(in)::dffts
complex(DP)::tg_psi(dffts%nnr_tg)
complex(DP)::psi(ngms,nbnd)
logical,intent(in)::gamma_only
integer,intent(in)::ibnd,nbnd,ngms
TYPE(fft_type_descriptor),intent(in)::dffts
complex(DP)::psic(dffts%nnr)
complex(DP)::psi(ngms,nbnd)
logical,intent(in)::gamma_only
integer::j
integer,intent(in)::ibnd,nbnd,ngms
TYPE(fft_type_descriptor)::dffts
complex(DP)::psic(dffts%nnr)
complex(DP)::hpsi(ngms,nbnd)
logical,intent(in)::gamma_only
complex(DP)::fp,fm
integer,intent(in)::ibnd,nbnd,ngms
TYPE(fft_type_descriptor)::dffts
complex(DP)::tg_psic(dffts%nnr_tg)
complex(DP)::hpsi(ngms,nbnd)
logical,intent(in)::gamma_only
complex(DP)::fp,fm
TYPE(fft_type_descriptor)::dfftp,dffts,dfft3d
INTEGER::nx=128
INTEGER::ny=128
INTEGER::nz=256
INTEGER::mype,npes,comm,ntgs,root,nbnd
LOGICAL::iope
INTEGER::ierr,i,j,k,ncount,ib,ireq,nreq,ipsi,iloop
INTEGER::stdout
INTEGER::ngw_,ngm_,ngs_
REAL*8::gcutm,gkcut,gcutms
REAL*8::ecutm,ecutw,ecutms
REAL*8::ecutwfc,ecutrho
REAL*8::tpiba,alat,alat_in
REAL*8::time(100),my_time(100),time_min(100),time_max(100),time_avg(100)
REAL*8::wall
REAL*8::wall_avg
REAL*8::tmp1(10000),tmp2(10000)
LOGICAL::gamma_only
REAL*8::at(3,3),bg(3,3)
REAL(DP),PARAMETER::pi=3.14159265358979323846_DP
COMPLEX(DP),ALLOCATABLE::psis(:,:)
COMPLEX(DP),ALLOCATABLE::aux(:)
COMPLEX(DP)::f_aux,ff(5)
integer::nargs
CHARACTER(LEN=80)::arg
INTEGER::PROVIDED
real(DP)::a1(3),a2(3),a3(3),b1(3),b2(3),b3(3)
real(DP)::den,s
integer::iperm,i,j,k,l,ipol
character(len=*)::label
character(len=*)::label
TYPE(tester_t)::test
complex(DP),device::c_d(:)
complex(DP)::c(:)
integer,intent(in)::n
real(DP),ALLOCATABLE::rnd_aux(:)
TYPE(tester_t)::test
integer(kind=cuda_stream_kind)::stream=0
integer,parameter::nsl=100,nz=56,ldz=56
real(DP)::rnd_aux(2*nsl*ldz)
complex(DP),device::c_d(nsl*ldz)
complex(DP),device::cout_d(nsl*ldz)
complex(DP)::c(nsl*ldz)
complex(DP)::cout(nsl*ldz)
TYPE(tester_t)::test
integer(kind=cuda_stream_kind)::stream=0
integer,parameter::nx=10,ny=10,nzl=5,ldx=10,ldy=10
real(DP)::rnd_aux(2*nzl*ldx*ldy)
complex(DP),device::c_d(nzl*ldx*ldy)
complex(DP),device::tmp_d(nzl*ldx*ldy)
complex(DP)::c(nzl*ldx*ldy)
complex(DP)::tmp(nzl*ldx*ldy)
TYPE(tester_t)::test
integer(kind=cuda_stream_kind)::stream=0
integer,parameter::nx=10,ny=10,nz=10
integer,parameter::ldx=10,ldy=10,ldz=10
integer,parameter::howmany=1
integer,parameter::howmany=12
real(DP)::rnd_aux(2*howmany*ldx*ldy*ldz)
complex(DP),device::c_d(howmany*ldx*ldy*ldz)
complex(DP),device::tmp_d(howmany*ldx*ldy*ldz)
complex(DP)::c(howmany*ldx*ldy*ldz)
complex(DP)::tmp(howmany*ldx*ldy*ldz)
integer::i,rs,re
TYPE(tester_t)::test
integer(kind=cuda_stream_kind)::stream=0
integer,parameter::nx=10,ny=10,nz=10
integer,parameter::ldx=10,ldy=10,ldz=10,howmany=1
real(DP)::rnd_aux(2*howmany*ldx*ldy*ldz)
complex(DP),device::c_d(howmany*ldx*ldy*ldz)
complex(DP),device::tmp_d(howmany*ldx*ldy*ldz)
complex(DP)::c(howmany*ldx*ldy*ldz)
complex(DP)::tmp(howmany*ldx*ldy*ldz)
integer::do_fft_y(ldx),do_fft_z(ldx*ldy)
integer::me,n,root,comm
TYPE(mpi_t)::mp
TYPE(tester_t)::test
INTEGER::ierr,level,i
integer,intent(out)::mpme,npes,mproot,comm
integer::ierr
TYPE(fft_type_descriptor)::dfft
TYPE(sticks_map)::smap
CHARACTER(LEN=*),INTENT(IN)::flavor
LOGICAL::gamma_only
LOGICAL::parallel
INTEGER::comm,nyfft
REAL(DP),PARAMETER::pi=4.D0*DATAN(1.D0)
REAL(DP)::at(3,3),bg(3,3)
TYPE(fft_type_descriptor)::dfft
TYPE(sticks_map)::smap
complex(DP),device::c_d(:)
complex(DP)::c(:)
integer,intent(in)::n
real(DP),ALLOCATABLE::rnd_aux(:)
TYPE(mpi_t)::mp
TYPE(tester_t)::test
TYPE(fft_type_descriptor)::dfft
TYPE(sticks_map)::smap
LOGICAL,INTENT(IN)::gamma_only
INTEGER,INTENT(IN)::ny
LOGICAL::parallel
COMPLEX(DP),ALLOCATABLE::scatter_in(:),scatter_out(:),aux(:)
COMPLEX(DP),ALLOCATABLE,DEVICE::scatter_in_d(:),scatter_out_d(:)
integer(kind=cuda_stream_kind)::stream=0
integer::fft_sign=2
integer::vsiz,nr1p_,compare_len,me2
TYPE(mpi_t)::mp
TYPE(tester_t)::test
TYPE(fft_type_descriptor)::dfft
TYPE(sticks_map)::smap
LOGICAL,INTENT(IN)::gamma_only
INTEGER,INTENT(IN)::ny
LOGICAL::parallel
COMPLEX(DP),ALLOCATABLE::scatter_in(:),scatter_out(:),aux(:)
COMPLEX(DP),ALLOCATABLE,DEVICE::scatter_in_d(:),scatter_out_d(:)
integer(kind=cuda_stream_kind)::stream=0
integer::fft_sign=2
integer::vsiz,compare_len,my_nr1p_
TYPE(mpi_t)::mp
TYPE(tester_t)::test
TYPE(fft_type_descriptor)::dfft
TYPE(sticks_map)::smap
LOGICAL,INTENT(IN)::gamma_only
INTEGER,INTENT(IN)::ny
INTEGER,PARAMETER::howmany=4
LOGICAL::parallel
COMPLEX(DP),ALLOCATABLE::scatter_in(:),scatter_in_cpy(:),scatter_out(:),aux(:)
COMPLEX(DP),ALLOCATABLE,DEVICE::scatter_in_d(:),scatter_out_d(:),aux_d(:)
integer::i,l,start_in,end_in,start_out,end_out,nstick_zx,n3,n3x,vsiz
integer::start_sl,end_sl
character(len=*)::label
character(len=*)::label
integer::me,n,root,comm
TYPE(mpi_t)::mp
TYPE(tester_t)::test
INTEGER::ierr,level,i
integer,intent(out)::mpme,npes,mproot,comm
integer::ierr
REAL(DP),PARAMETER::pi=4.D0*DATAN(1.D0)
REAL(DP),INTENT(IN)::at(3,3)
REAL(DP),INTENT(OUT)::bg(3,3)
REAL(DP)::ucvol
TYPE(fft_type_descriptor)::dfft
TYPE(sticks_map)::smap
CHARACTER(LEN=*),INTENT(IN)::flavor
LOGICAL::gamma_only
LOGICAL::parallel
INTEGER::comm,nyfft
REAL(DP)::at(3,3),bg(3,3)
TYPE(fft_type_descriptor)::dfft
TYPE(sticks_map)::smap
complex(DP),device::c_d(:)
complex(DP)::c(:)
integer,intent(in)::n
real(DP),ALLOCATABLE::rnd_aux(:)
TYPE(mpi_t)::mp
TYPE(tester_t)::test
TYPE(fft_type_descriptor)::dfft
TYPE(sticks_map)::smap
LOGICAL,INTENT(IN)::gamma_only
INTEGER,INTENT(IN)::ny
LOGICAL::parallel
COMPLEX(DP),ALLOCATABLE::data_in(:),aux(:)
COMPLEX(DP),ALLOCATABLE,DEVICE::data_in_d(:)
INTEGER::i
TYPE(mpi_t)::mp
TYPE(tester_t)::test
TYPE(fft_type_descriptor)::dfft
TYPE(sticks_map)::smap
LOGICAL,INTENT(IN)::gamma_only
INTEGER,INTENT(IN)::ny
LOGICAL::parallel
COMPLEX(DP),ALLOCATABLE::data_in(:),aux(:)
COMPLEX(DP),ALLOCATABLE,DEVICE::data_in_d(:)
TYPE(mpi_t)::mp
TYPE(tester_t)::test
TYPE(fft_type_descriptor)::dfft
TYPE(sticks_map)::smap
LOGICAL,INTENT(IN)::gamma_only
INTEGER,INTENT(IN)::ny
LOGICAL::parallel
COMPLEX(DP),ALLOCATABLE::data_in(:),aux(:)
COMPLEX(DP),ALLOCATABLE,DEVICE::data_in_d(:)
integer,parameter::howmany=4
INTEGER::i,start
TYPE(mpi_t)::mp
TYPE(tester_t)::test
TYPE(fft_type_descriptor)::dfft
TYPE(sticks_map)::smap
LOGICAL,INTENT(IN)::gamma_only
INTEGER,INTENT(IN)::ny
LOGICAL::parallel
COMPLEX(DP),ALLOCATABLE::data_in(:),aux(:)
COMPLEX(DP),ALLOCATABLE,DEVICE::data_in_d(:)
INTEGER(kind=cuda_stream_kind)::strm=0
integer,parameter::howmany=4
integer::start,i
character(len=*)::label
character(len=*)::label
type::tester_t
integer(int32)::n_errors=0_int32
integer(int32)::n_tests=0_int32
real(real32)::tolerance32=2._real32*epsilon(1._real32)
real(real64)::tolerance64=2._real64*epsilon(1._real64)
real(real64),intent(in),optional::tolerance64
logical,intent(in),optional::errorstop
logical::do_errorstop
integer(int8),intent(in)::i1
integer(int8),intent(in)::i2
logical,intent(in),optional::fail
integer(int16),intent(in)::i1
integer(int16),intent(in)::i2
logical,intent(in),optional::fail
integer(int32),intent(in)::i1
integer(int32),intent(in)::i2
logical,intent(in),optional::fail
integer(int64),intent(in)::i1
integer(int64),intent(in)::i2
logical,intent(in),optional::fail
real(real32),intent(in)::r1
real(real32),intent(in)::r2
logical,intent(in),optional::fail
real(real64),intent(in)::r1
real(real64),intent(in)::r2
logical,intent(in),optional::fail
complex(real32),intent(in)::c1
complex(real32),intent(in)::c2
logical,intent(in),optional::fail
complex(real64),intent(in)::c1
complex(real64),intent(in)::c2
logical,intent(in),optional::fail
logical,intent(in)::l1
logical,intent(in)::l2
logical,intent(in),optional::fail
integer(int8),dimension(:),intent(in)::i1
integer(int8),dimension(:),intent(in)::i2
logical,intent(in),optional::fail
integer(int16),dimension(:),intent(in)::i1
integer(int16),dimension(:),intent(in)::i2
logical,intent(in),optional::fail
integer(int32),dimension(:),intent(in)::i1
integer(int32),dimension(:),intent(in)::i2
logical,intent(in),optional::fail
integer(int64),dimension(:),intent(in)::i1
integer(int64),dimension(:),intent(in)::i2
logical,intent(in),optional::fail
real(real32),dimension(:),intent(in)::r1
real(real32),dimension(:),intent(in)::r2
logical,intent(in),optional::fail
real(real64),dimension(:),intent(in)::r1
real(real64),dimension(:),intent(in)::r2
logical,intent(in),optional::fail
complex(real32),dimension(:),intent(in)::c1
complex(real32),dimension(:),intent(in)::c2
logical,intent(in),optional::fail
complex(real64),dimension(:),intent(in)::c1
complex(real64),dimension(:),intent(in)::c2
logical,intent(in),optional::fail
logical,intent(in),dimension(:)::l1
logical,intent(in),dimension(:)::l2
logical,intent(in),optional::fail
integer::k
integer(int8),intent(in)::i
logical,intent(in),optional::fail
integer(int16),intent(in)::i
logical,intent(in),optional::fail
integer(int32),intent(in)::i
logical,intent(in),optional::fail
integer(int64),intent(in)::i
logical,intent(in),optional::fail
real(real32),intent(in)::r
logical,intent(in),optional::fail
real(real64),intent(in)::r
logical,intent(in),optional::fail
integer(int8),dimension(:),intent(in)::i
logical,intent(in),optional::fail
integer(int16),dimension(:),intent(in)::i
logical,intent(in),optional::fail
integer(int32),dimension(:),intent(in)::i
logical,intent(in),optional::fail
integer(int64),dimension(:),intent(in)::i
logical,intent(in),optional::fail
real(real32),dimension(:),intent(in)::r
logical,intent(in),optional::fail
real(real64),dimension(:),intent(in)::r
logical,intent(in),optional::fail
real(real32),intent(in)::r1
real(real32),intent(in)::r2
logical,intent(in),optional::fail
real(real64),intent(in)::r1
real(real64),intent(in)::r2
logical,intent(in),optional::fail
real(real32),intent(in),dimension(:)::r1
real(real32),intent(in),dimension(:)::r2
logical,intent(in),optional::fail
real(real64),intent(in),dimension(:)::r1
real(real64),intent(in),dimension(:)::r2
logical,intent(in),optional::fail
complex(real32),intent(in)::c1
complex(real32),intent(in)::c2
logical,intent(in),optional::fail
complex(real64),intent(in)::r1
complex(real64),intent(in)::c2
logical,intent(in),optional::fail
complex(real32),intent(in),dimension(:)::c1
complex(real32),intent(in),dimension(:)::c2
logical,intent(in),optional::fail
complex(real64),intent(in),dimension(:)::c1
complex(real64),intent(in),dimension(:)::c2
logical,intent(in),optional::fail
TYPE(tester_t)::test
INTEGER::itottests,itoterr,ierr,me
CHARACTER(len=*),INTENT(IN)::test_name
INTEGER,INTENT(IN)::mpime
INTEGER,PARAMETER::in_unit=20,out_unit=21
CHARACTER(len=80)::fname
INTEGER::n,istat
INTEGER,ALLOCATABLE::seed(:)
INTEGER::ierr
TYPE(fft_type_descriptor),INTENT(in)::dffts
REAL(DP),INTENT(IN)::v(dffts%nnr)
REAL(DP),INTENT(OUT)::tg_v(dffts%nnr_tg)
INTEGER::nxyp,ir3,off,tg_off
INTEGER::i,nsiz,ierr
TYPE(fft_type_descriptor),INTENT(in)::dffts
COMPLEX(DP),INTENT(IN)::v(dffts%nnr)
COMPLEX(DP),INTENT(OUT)::tg_v(dffts%nnr_tg)
INTEGER::nxyp,ir3,off,tg_off
INTEGER::i,nsiz,ierr
TYPE(fft_type_descriptor),INTENT(in)::dffts
REAL(DP),DEVICE,INTENT(IN)::v_d(dffts%nnr)
REAL(DP),DEVICE,INTENT(OUT)::tg_v_d(dffts%nnr_tg)
REAL(DP),ALLOCATABLE::tg_v_mpi(:)
INTEGER::nxyp,ir3,off,tg_off
INTEGER::i,nsiz,ierr
INTEGER::nr1x,nr2x,my_nr2p,my_i0r2p
TYPE(fft_type_descriptor),INTENT(in)::dffts
COMPLEX(DP),DEVICE,INTENT(IN)::v_d(dffts%nnr)
COMPLEX(DP),DEVICE,INTENT(OUT)::tg_v_d(dffts%nnr_tg)
COMPLEX(DP),ALLOCATABLE::tg_v_mpi(:)
INTEGER::nxyp,ir3,off,tg_off
INTEGER::i,nsiz,ierr
INTEGER::nr1x,nr2x,my_nr2p,my_i0r2p
