INTEGER,INTENT(IN)::nat,me,nproc
INTEGER,INTENT(OUT)::ia_s,ia_e,mykey
INTEGER::na_loc,r,nproc_ia
CHARACTER,INTENT(IN)::grid_shape
INTEGER,INTENT(IN)::nproc
INTEGER,INTENT(OUT)::nprow,npcol
INTEGER::sqrtnp,i
CHARACTER,INTENT(IN)::order
INTEGER,INTENT(IN)::rank
INTEGER,INTENT(IN)::nprow,npcol
INTEGER,INTENT(OUT)::row,col
CHARACTER,INTENT(IN)::order
INTEGER,INTENT(OUT)::rank
INTEGER,INTENT(IN)::nprow,npcol
INTEGER,INTENT(IN)::row,col
INTEGER::gdim,np,me,r,q
INTEGER::gdim,np,me,r,q
INTEGER::gdim,np,me,nb
INTEGER::ig,nx,np,me
INTEGER,INTENT(IN)::lind,n,me,np
INTEGER,INTENT(IN)::lind,n,me,np
INTEGER,INTENT(IN)::lind,n,me,np
LOGICAL,INTENT(IN)::tv
INTEGER,intent(in)::N,NRL,LDA,LDV
INTEGER,intent(in)::NPROC,ME,comm
REAL(DP)::A(LDA,N),D(N),E(N),V(LDV,N)
REAL(DP)::g,scalef,sigma,kappa,f,h,tmp
REAL(DP),ALLOCATABLE::u(:)
REAL(DP),ALLOCATABLE::p(:)
REAL(DP),ALLOCATABLE::vtmp(:)
REAL(DP)::tu,tp,one_over_h
REAL(DP)::one_over_scale
REAL(DP)::redin(3),redout(3)
REAL(DP),ALLOCATABLE::ul(:)
REAL(DP),ALLOCATABLE::pl(:)
integer::l,i,j,k,t,tl,ierr
integer::kl,jl,ks,lloc
integer,ALLOCATABLE::is(:)
integer,ALLOCATABLE::ri(:)
LOGICAL,INTENT(IN)::tv
INTEGER,INTENT(IN)::n,nrl,ldz,mpime,comm
REAL(DP)::d(n),e(n)
REAL(DP)::z(ldz,n)
INTEGER::i,iter,mk,k,l,m,ierr
REAL(DP)::b,dd,f,g,p,r,c,s
REAL(DP),ALLOCATABLE::cv(:,:)
REAL(DP),ALLOCATABLE::fv1(:)
REAL(DP),ALLOCATABLE::fv2(:)
LOGICAL,INTENT(IN)::tv
INTEGER,INTENT(IN)::n,ldv,nrl
REAL(DP),INTENT(INOUT)::d(n),v(ldv,n)
INTEGER::i,j,k
REAL(DP)::p
REAL(DP)::a,b,pythag
REAL(DP)::absa,absb
LOGICAL,INTENT(IN)::tv
INTEGER,INTENT(IN)::nb,n,ortho_cntx,ortho_comm
INTEGER,INTENT(IN)::lds
REAL(DP)::s(:,:),w(:)
INTEGER::desch(10)
REAL(DP)::rtmp(4)
INTEGER::itmp(4)
REAL(DP),ALLOCATABLE::work(:)
REAL(DP),ALLOCATABLE::vv(:,:)
INTEGER,ALLOCATABLE::iwork(:)
INTEGER::LWORK,LIWORK,info
CHARACTER::jobv
INTEGER::i,ierr
INTEGER::nprow,npcol,my_prow,my_pcol,mpi_comm_rows,mpi_comm_cols
LOGICAL::success
CHARACTER,INTENT(IN)::JOBZ
INTEGER,INTENT(IN)::lda,ldz,nrl,n,nproc,mpime
INTEGER,INTENT(IN)::comm
REAL(DP)::ap(lda,*),w(*),z(ldz,*)
REAL(DP),ALLOCATABLE::sd(:)
LOGICAL::tv
CHARACTER::JOBZ,UPLO
INTEGER::IOPT,INFO,LDZ,N
REAL(DP)::AP(*),W(*),Z(LDZ,*)
REAL(DP),ALLOCATABLE::WORK(:)
CHARACTER(LEN=*),INTENT(IN)::calling_routine,message
INTEGER,INTENT(IN)::ierr
CHARACTER(LEN=6)::cerr
INTEGER::info
INTEGER,INTENT(IN)::n,m,ldh
COMPLEX(DP),INTENT(INOUT)::h(ldh,n),s(ldh,n)
REAL(DP),INTENT(OUT)::e(n)
COMPLEX(DP),INTENT(OUT)::v(ldh,m)
INTEGER,INTENT(IN)::me_bgrp,root_bgrp,intra_bgrp_comm
LOGICAL,OPTIONAL::offload
LOGICAL::loffload
COMPLEX(DP),ALLOCATABLE,DEVICE::v_d(:,:),h_d(:,:),s_d(:,:)
REAL(DP),ALLOCATABLE,DEVICE::e_d(:)
INTEGER::info
INTEGER,INTENT(IN)::n,m,ldh
COMPLEX(DP),DEVICE,INTENT(INOUT)::h_d(ldh,n),s_d(ldh,n)
REAL(DP),DEVICE,INTENT(OUT)::e_d(n)
COMPLEX(DP),DEVICE,INTENT(OUT)::v_d(ldh,n)
INTEGER,INTENT(IN)::me_bgrp,root_bgrp,intra_bgrp_comm
LOGICAL,OPTIONAL::onhost
LOGICAL::lonhost
COMPLEX(DP),ALLOCATABLE::v(:,:),h(:,:),s(:,:)
REAL(DP),ALLOCATABLE::e(:)
INTEGER::info
INTEGER,INTENT(IN)::n,m,ldh
REAL(DP),INTENT(INOUT)::h(ldh,n),s(ldh,n)
REAL(DP),INTENT(OUT)::e(n)
REAL(DP),INTENT(OUT)::v(ldh,m)
INTEGER,INTENT(IN)::me_bgrp,root_bgrp,intra_bgrp_comm
LOGICAL,OPTIONAL::offload
LOGICAL::loffload
REAL(DP),ALLOCATABLE,DEVICE::v_d(:,:),h_d(:,:),s_d(:,:)
REAL(DP),ALLOCATABLE,DEVICE::e_d(:)
INTEGER::info
INTEGER,INTENT(IN)::n,m,ldh
REAL(DP),DEVICE,INTENT(INOUT)::h_d(ldh,n),s_d(ldh,n)
REAL(DP),DEVICE,INTENT(OUT)::e_d(n)
REAL(DP),DEVICE,INTENT(OUT)::v_d(ldh,n)
INTEGER,INTENT(IN)::me_bgrp,root_bgrp,intra_bgrp_comm
LOGICAL,OPTIONAL::onhost
LOGICAL::lonhost
REAL(DP),ALLOCATABLE::v(:,:),h(:,:),s(:,:)
REAL(DP),ALLOCATABLE::e(:)
INTEGER::info
INTEGER,INTENT(IN)::n,ldh
REAL(DP),INTENT(INOUT)::h(ldh,ldh),s(ldh,ldh)
REAL(DP),INTENT(OUT)::e(n)
REAL(DP),INTENT(OUT)::v(ldh,ldh)
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
LOGICAL,OPTIONAL::offload
LOGICAL::loffload
INTEGER,INTENT(IN)::n,ldh
COMPLEX(DP),INTENT(INOUT)::h(ldh,ldh),s(ldh,ldh)
REAL(DP),INTENT(OUT)::e(n)
COMPLEX(DP),INTENT(OUT)::v(ldh,ldh)
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
LOGICAL,OPTIONAL::offload
LOGICAL::loffload
INTEGER,INTENT(IN)::n,ldh
REAL(DP),INTENT(INOUT),DEVICE::h_d(ldh,ldh),s_d(ldh,ldh)
REAL(DP),INTENT(OUT),DEVICE::e_d(n)
REAL(DP),INTENT(OUT),DEVICE::v_d(ldh,ldh)
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
LOGICAL,OPTIONAL::onhost
LOGICAL::lonhost
REAL(DP),ALLOCATABLE::v(:,:),h(:,:),s(:,:)
REAL(DP),ALLOCATABLE::e(:)
INTEGER,INTENT(IN)::n,ldh
COMPLEX(DP),INTENT(INOUT),DEVICE::h_d(ldh,ldh),s_d(ldh,ldh)
REAL(DP),INTENT(OUT),DEVICE::e_d(n)
COMPLEX(DP),INTENT(OUT),DEVICE::v_d(ldh,ldh)
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
LOGICAL,OPTIONAL::onhost
LOGICAL::lonhost
COMPLEX(DP),ALLOCATABLE::v(:,:),h(:,:),s(:,:)
REAL(DP),ALLOCATABLE::e(:)
INTEGER,PARAMETER::MPI_COMM_WORLD=0
INTEGER,PARAMETER::MPI_COMM_NULL=-1
INTEGER,PARAMETER::MPI_COMM_SELF=-2
INTEGER::ir=0
INTEGER::nr=0
INTEGER::ic=0
INTEGER::nc=0
INTEGER::nrcx=0
INTEGER::active_node=0
INTEGER::n=0
INTEGER::nx=0
INTEGER::npr=0
INTEGER::npc=0
INTEGER::myr=0
INTEGER::myc=0
INTEGER::comm=0
INTEGER::cntx=-1
INTEGER::mype=0
INTEGER::nrl=0
INTEGER::nrlx=0
TYPE(la_descriptor),INTENT(OUT)::descla
INTEGER,INTENT(IN)::n
INTEGER,INTENT(IN)::nx
INTEGER,INTENT(IN)::np(2),me(2),comm,cntx
INTEGER,INTENT(IN)::includeme
INTEGER::ir,nr,ic,nc,lnode,nrcx,nrl,nrlx
INTEGER::ip,npp
TYPE(la_descriptor),INTENT(IN)::descla
INTEGER,INTENT(OUT)::idesc(LAX_DESC_SIZE)
TYPE(la_descriptor),INTENT(OUT)::descla
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
INTEGER,INTENT(IN)::n,m,ldh
REAL(DP),INTENT(INOUT)::h(ldh,n),s(ldh,n)
REAL(DP),INTENT(OUT)::e(n)
REAL(DP),INTENT(OUT)::v(ldh,m)
INTEGER,INTENT(IN)::me_bgrp,root_bgrp,intra_bgrp_comm
INTEGER,INTENT(IN)::n,m,ldh
REAL(DP),DEVICE,INTENT(INOUT)::h(ldh,n),s(ldh,n)
REAL(DP),DEVICE,INTENT(OUT)::e(n)
REAL(DP),DEVICE,INTENT(OUT)::v(ldh,m)
INTEGER,INTENT(IN)::me_bgrp,root_bgrp,intra_bgrp_comm
INTEGER,INTENT(IN)::n,m,ldh
COMPLEX(DP),INTENT(INOUT)::h(ldh,n),s(ldh,n)
REAL(DP),INTENT(OUT)::e(n)
COMPLEX(DP),INTENT(OUT)::v(ldh,m)
INTEGER,INTENT(IN)::me_bgrp,root_bgrp,intra_bgrp_comm
INTEGER,INTENT(IN)::n,m,ldh
COMPLEX(DP),DEVICE,INTENT(INOUT)::h(ldh,n),s(ldh,n)
REAL(DP),DEVICE,INTENT(OUT)::e(n)
COMPLEX(DP),DEVICE,INTENT(OUT)::v(ldh,m)
INTEGER,INTENT(IN)::me_bgrp,root_bgrp,intra_bgrp_comm
INTEGER,INTENT(IN)::n,ldh
COMPLEX(DP),INTENT(INOUT)::h(ldh,ldh),s(ldh,ldh)
REAL(DP),INTENT(OUT)::e(n)
COMPLEX(DP),INTENT(OUT)::v(ldh,ldh)
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
INTEGER,INTENT(IN)::n,ldh
REAL(DP),INTENT(INOUT)::h(ldh,ldh),s(ldh,ldh)
REAL(DP),INTENT(OUT)::e(n)
REAL(DP),INTENT(OUT)::v(ldh,ldh)
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
REAL(DP),INTENT(IN)::lambda(:,:,:),ccc
INTEGER,INTENT(IN)::idesc(:,:)
INTEGER,INTENT(IN)::n,nshow,nudx
LOGICAL,INTENT(IN)::ionode
INTEGER,INTENT(IN)::iunit
REAL(DP),INTENT(IN)::rhos(:,:)
REAL(DP)::rhod(:)
REAL(DP)::s(:,:)
INTEGER,INTENT(IN)::n
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
INTEGER,INTENT(IN)::n
REAL(DP)::rhos(:,:)
REAL(DP)::rhod(:)
INTEGER,INTENT(IN)::m
REAL(DP),DEVICE,INTENT(IN)::rhos(:,:)
REAL(DP),DEVICE,INTENT(OUT)::rhod(:)
REAL(DP),DEVICE,INTENT(OUT)::s(:,:)
INTEGER,INTENT(OUT)::info
INTEGER,INTENT(IN)::nsiz
INTEGER,INTENT(OUT)::nx
LOGICAL,INTENT(OUT)::la_proc
INTEGER,INTENT(OUT)::idesc(LAX_DESC_SIZE)
INTEGER,INTENT(OUT),ALLOCATABLE::rank_ip(:,:)
INTEGER,INTENT(OUT),ALLOCATABLE::idesc_ip(:,:,:)
INTEGER,INTENT(IN)::nsiz
INTEGER,INTENT(OUT)::nx
LOGICAL,INTENT(OUT)::la_proc
INTEGER,INTENT(OUT)::idesc(LAX_DESC_SIZE)
INTEGER,INTENT(OUT),ALLOCATABLE::rank_ip(:,:)
INTEGER,INTENT(OUT),ALLOCATABLE::irc_ip(:)
INTEGER,INTENT(OUT),ALLOCATABLE::nrc_ip(:)
INTEGER,PARAMETER::DP=selected_real_kind(14,200)
INTEGER,PARAMETER::SP=selected_real_kind(5,20)
LOGICAL,INTENT(IN)::tv
INTEGER,INTENT(IN)::n,ldh
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
REAL(DP)::hh(ldh,ldh)
REAL(DP)::e(n)
LOGICAL,INTENT(IN)::tv
INTEGER,INTENT(IN)::n,ldh
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
COMPLEX(DP)::hh(ldh,ldh)
REAL(DP)::e(n)
integer::n,ldx
integer,INTENT(IN)::idesc(LAX_DESC_SIZE)
complex(DP)::sll(ldx,ldx)
integer::n,ldx
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
REAL(DP)::sll(ldx,ldx)
INTEGER,INTENT(IN)::n,ldx
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
COMPLEX(DP),INTENT(INOUT)::sll(ldx,ldx)
INTEGER,INTENT(IN)::n,ldx
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
REAL(DP),INTENT(INOUT)::sll(ldx,ldx)
INTEGER::me_ortho(2)=0
INTEGER::me_ortho1=0
INTEGER::nproc_ortho=1
INTEGER::leg_ortho=1
INTEGER::ortho_comm=0
INTEGER::ortho_row_comm=0
INTEGER::ortho_col_comm=0
INTEGER::ortho_comm_id=0
INTEGER::ortho_parent_comm=0
INTEGER::me_blacs=0
INTEGER::np_blacs=1
INTEGER::world_cntx=-1
INTEGER::ortho_cntx=-1
LOGICAL::do_distr_diag_inside_bgrp=.true.
LOGICAL,SAVE::lax_is_initialized=.false.
INTEGER::laxlib_rank
INTEGER,INTENT(IN)::comm
INTEGER::ierr,taskid
INTEGER::laxlib_size
INTEGER,INTENT(IN)::comm
INTEGER::ierr,numtask
INTEGER,INTENT(IN)::old_comm
INTEGER,INTENT(IN)::color,key
INTEGER,INTENT(OUT)::new_comm
INTEGER::ierr
INTEGER,INTENT(INOUT)::comm
INTEGER::ierr
INTEGER::MPI_MAX_PROCESSOR_NAME=64
INTEGER::mype,npes,comm,ntgs,root
LOGICAL::iope
INTEGER::ierr
INTEGER::stdout
INTEGER::me_ortho(2)=0
INTEGER::me_ortho1=0
INTEGER::nproc_ortho=1
INTEGER::ortho_comm=0
INTEGER::ortho_row_comm=0
INTEGER::ortho_col_comm=0
INTEGER::ortho_comm_id=0
INTEGER::ortho_parent_comm=0
INTEGER::me_blacs=0
INTEGER::np_blacs=1
INTEGER::world_cntx=-1
INTEGER::ortho_cntx=-1
LOGICAL::do_distr_diag_inside_bgrp=.FALSE.
LOGICAL::la_proc
INTEGER,ALLOCATABLE::rank_ip(:,:)
INTEGER,ALLOCATABLE::irc_ip(:)
INTEGER,ALLOCATABLE::nrc_ip(:)
INTEGER,ALLOCATABLE::idesc_ip(:,:,:)
REAL(DP),ALLOCATABLE::a(:,:)
REAL(DP),ALLOCATABLE::s(:,:)
REAL(DP),ALLOCATABLE::c(:,:)
REAL(DP),ALLOCATABLE::d(:)
REAL(DP)::time1,time2
REAL*8::tempo(100)
REAL*8,allocatable::tempo_tutti(:)
REAL*8,allocatable::perf_matrix(:,:)
REAL*8,allocatable::latency_matrix(:,:)
integer,allocatable::perf_count(:,:)
REAL*8::tempo_mio(100)
REAL*8::tempo_min(100)
REAL*8::tempo_max(100)
REAL*8::tempo_avg(100)
TYPE(la_descriptor)::desc
INTEGER::idesc(LAX_DESC_SIZE)
INTEGER::i,ir,ic,nx,n,nr,nc
INTEGER::n_in,nlen,dest,sour,tag,ii
INTEGER::nnodes
integer::nargs
CHARACTER(LEN=80)::arg
CHARACTER(LEN=MPI_MAX_PROCESSOR_NAME),allocatable::proc_name(:)
CHARACTER(LEN=MPI_MAX_PROCESSOR_NAME),allocatable::node_name(:)
INTEGER,allocatable::proc2node(:)
INTEGER::PROVIDED
INTEGER::i,j,ii,jj
INTEGER::nnode=1
INTEGER::nproc=1
INTEGER::mpime=0
INTEGER::root=0
INTEGER::world_comm=0
LOGICAL::library_mode=.FALSE.
INTEGER,INTENT(IN)::my_world_comm
INTEGER::ierr
INTEGER::PROVIDED
INTEGER::ierr
TYPE(tester_t)::test
INTEGER::world_group=0
TYPE(tester_t)::test
real(DP)::h(2,2)
real(DP)::s(2,2)
real(DP)::e(2)
real(DP)::v(2,2)
TYPE(tester_t)::test
complex(DP)::h(2,2)
complex(DP)::h_save(2,2)
complex(DP)::s(2,2)
complex(DP)::s_save(2,2)
real(DP)::e(2)
complex(DP)::v(2,2)
TYPE(tester_t)::test
INTEGER::world_group=0
TYPE(tester_t)::test
integer,parameter::m_size=1024
complex(DP)::h(m_size,m_size)
complex(DP)::h_save(m_size,m_size)
complex(DP)::s(m_size,m_size)
complex(DP)::s_save(m_size,m_size)
real(DP)::e(m_size)
complex(DP)::v(m_size,m_size)
real(DP)::e_save(m_size)
complex(DP)::v_save(m_size,m_size)
integer,intent(in)::msize
complex(dp),intent(out)::M(:,:)
real(dp),allocatable::rnd(:)
complex(dp),allocatable::tmp(:,:)
INTEGER::h,k,j
TYPE(tester_t)::test
INTEGER::world_group=0
TYPE(tester_t)::test
integer::ldh,n,m
real(DP),allocatable::h(:,:)
real(DP),allocatable::h_save(:,:)
real(DP),allocatable::s(:,:)
real(DP),allocatable::s_save(:,:)
real(DP),allocatable::e(:)
real(DP),allocatable::v(:,:)
real(DP),allocatable::e_save(:)
real(DP),allocatable::v_save(:,:)
character(len=20)::inputs(2)
integer::i,j,info
TYPE(tester_t)::test
integer::ldh,n,m
complex(DP),allocatable::h(:,:)
complex(DP),allocatable::h_save(:,:)
complex(DP),allocatable::s(:,:)
complex(DP),allocatable::s_save(:,:)
real(DP),allocatable::e(:)
complex(DP),allocatable::v(:,:)
real(DP),allocatable::e_save(:)
complex(DP),allocatable::v_save(:,:)
character(len=20)::inputs(4)
integer::i,j,info
TYPE(tester_t)::test
INTEGER::world_group=0
TYPE(tester_t)::test
TYPE(la_descriptor)::desc
integer::ldh,n,m
real(DP),allocatable::h(:,:),hdst(:,:)
real(DP),allocatable::s(:,:),sdst(:,:)
real(DP),allocatable::e(:)
real(DP),allocatable::v(:,:),vdst(:,:)
character(len=20)::inputs(2)
integer::l,i,j,ii,jj,info,nrdst
logical::la_proc
TYPE(tester_t)::test
integer::ldh,n,m
complex(DP),allocatable::h(:,:),hdst(:,:)
complex(DP),allocatable::s(:,:),sdst(:,:)
real(DP),allocatable::e(:)
complex(DP),allocatable::v(:,:),vdst(:,:)
TYPE(la_descriptor)::desc
character(len=20)::inputs(4)
integer::l,i,j,ii,jj,info,nrdst
logical::la_proc
TYPE(la_descriptor)::desc
INTEGER::n
INTEGER::ierr=0
INTEGER::color,key
INTEGER::me_ortho(2)=0
INTEGER::me_ortho1=0
INTEGER::nproc_ortho=1
INTEGER::ortho_comm=0
INTEGER::ortho_row_comm=0
INTEGER::ortho_col_comm=0
INTEGER::ortho_comm_id=0
TYPE(tester_t)::test
INTEGER::world_group=0
TYPE(tester_t)::test
real(DP),device::h_d(2,2)
real(DP),device::s_d(2,2)
real(DP),device::e_d(2)
real(DP),device::v_d(2,2)
real(DP)::h_h(2,2)
real(DP)::s_h(2,2)
real(DP)::e_h(2)
real(DP)::v_h(2,2)
TYPE(tester_t)::test
complex(DP),device::h_d(2,2)
complex(DP),device::s_d(2,2)
complex(DP),device::v_d(2,2)
real(DP),device::e_d(2)
complex(DP)::h_h(2,2)
complex(DP)::s_h(2,2)
complex(DP)::v_h(2,2)
real(DP)::e_h(2)
complex(DP)::s_save(2,2)
complex(DP)::h_save(2,2)
TYPE(tester_t)::test
INTEGER::world_group=0
TYPE(tester_t)::test
integer,parameter::m_size=1024
integer::i
complex(DP)::h(m_size,m_size)
complex(DP),DEVICE::h_d(m_size,m_size)
complex(DP)::h_save(m_size,m_size)
complex(DP)::s(m_size,m_size)
complex(DP),DEVICE::s_d(m_size,m_size)
complex(DP)::s_save(m_size,m_size)
real(DP)::e(m_size),e_(m_size)
real(DP),DEVICE::e_d(m_size)
complex(DP)::v(m_size,m_size)
complex(DP),DEVICE::v_d(m_size,m_size)
real(DP)::e_save(m_size)
complex(DP)::v_save(m_size,m_size)
integer,intent(in)::msize
complex(dp),intent(out)::M(:,:)
real(dp),allocatable::rnd(:)
complex(dp),allocatable::tmp(:,:)
INTEGER::h,k,j
TYPE(tester_t)::test
INTEGER::world_group=0
TYPE(tester_t)::test
integer::ldh,n,m
real(DP),allocatable::h(:,:)
real(DP),allocatable::h_save(:,:)
real(DP),allocatable::s(:,:)
real(DP),allocatable::s_save(:,:)
real(DP),allocatable::e(:)
real(DP),allocatable::v(:,:)
real(DP),allocatable::e_save(:)
real(DP),allocatable::v_save(:,:)
real(DP),allocatable::e_dc(:)
real(DP),allocatable::v_dc(:,:)!
real(DP),allocatable,device::h_d(:,:)
real(DP),allocatable,device::s_d(:,:)
real(DP),allocatable,device::e_d(:)
real(DP),allocatable,device::v_d(:,:)
character(len=20)::inputs(2)
integer::i,j,info
TYPE(tester_t)::test
integer::ldh,n,m
complex(DP),allocatable::h(:,:)
complex(DP),allocatable::h_save(:,:)
complex(DP),allocatable::s(:,:)
complex(DP),allocatable::s_save(:,:)
real(DP),allocatable::e(:)
complex(DP),allocatable::v(:,:)
real(DP),allocatable::e_save(:)
complex(DP),allocatable::v_save(:,:)
real(DP),allocatable::e_dc(:)
complex(DP),allocatable::v_dc(:,:)!
complex(DP),allocatable,device::h_d(:,:)
complex(DP),allocatable,device::s_d(:,:)
real(DP),allocatable,device::e_d(:)
complex(DP),allocatable,device::v_d(:,:)
character(len=20)::inputs(4)
integer::i,j,info
TYPE(tester_t)::test
INTEGER::world_group=0
TYPE(tester_t)::test
TYPE(la_descriptor)::desc
integer::ldh,n,m
real(DP),allocatable::h(:,:),hdst(:,:)
real(DP),allocatable,device::hdst_d(:,:)
real(DP),allocatable::s(:,:),sdst(:,:)
real(DP),allocatable,device::sdst_d(:,:)
real(DP),allocatable::e(:)
real(DP),allocatable,device::e_d(:)
real(DP),allocatable::v(:,:),vdst(:,:)
real(DP),allocatable,device::vdst_d(:,:)
character(len=20)::inputs(2)
integer::l,i,j,ii,jj,info,nrdst
logical::la_proc
TYPE(tester_t)::test
integer::ldh,n,m
complex(DP),allocatable::h(:,:),hdst(:,:)
complex(DP),allocatable,device::hdst_d(:,:)
complex(DP),allocatable::s(:,:),sdst(:,:)
complex(DP),allocatable,device::sdst_d(:,:)
real(DP),allocatable::e(:)
real(DP),allocatable,device::e_d(:)
complex(DP),allocatable::v(:,:),vdst(:,:)
complex(DP),allocatable,device::vdst_d(:,:)
TYPE(la_descriptor)::desc
character(len=20)::inputs(4)
integer::l,i,j,ii,jj,info,nrdst
logical::la_proc
TYPE(la_descriptor)::desc
INTEGER::n
INTEGER::ierr=0
INTEGER::color,key
INTEGER::me_ortho(2)=0
INTEGER::me_ortho1=0
INTEGER::nproc_ortho=1
INTEGER::ortho_comm=0
INTEGER::ortho_row_comm=0
INTEGER::ortho_col_comm=0
INTEGER::ortho_comm_id=0
complex(DP)::v(ldh,n)
complex(DP)::s(ldh,n)
real(DP)::e(n)
INTEGER::n
INTEGER::lwork,lrwork,liwork,info,ldh
REAL(DP)::abstol
INTEGER,ALLOCATABLE::iwork(:),ifail(:)
REAL(DP),ALLOCATABLE::rwork(:)
COMPLEX(DP),ALLOCATABLE::work(:)
REAL(DP)::v(ldh,n)
REAL(DP)::s(ldh,n)
real(DP)::e(n)
INTEGER::n
INTEGER::lwork,liwork,info,ldh
REAL(DP)::abstol
INTEGER,ALLOCATABLE::iwork(:),ifail(:)
REAL(DP),ALLOCATABLE::work(:)
character(len=*),intent(in)::fname
integer,intent(out)::ldh,n,m
complex(dp),allocatable,intent(inout)::h(:,:)
complex(dp),allocatable,intent(inout)::s(:,:)
real(dp),allocatable,intent(inout)::e(:)
complex(dp),allocatable,intent(inout)::v(:,:)
integer,intent(out)::info
real(dp)::aux1,aux2
integer::i,j,t
logical::exist
character(len=20)::fname_
character(len=*),intent(in)::fname
integer,intent(out)::ldh,n,m
real(dp),allocatable,intent(inout)::h(:,:)
real(dp),allocatable,intent(inout)::s(:,:)
real(dp),allocatable,intent(inout)::e(:)
real(dp),allocatable,intent(inout)::v(:,:)
integer,intent(out)::info
real(dp)::aux1,aux2
integer::i,j,t
logical::exist
character(len=20)::fname_
type::tester_t
integer(int32)::n_errors=0_int32
integer(int32)::n_tests=0_int32
real(real32)::tolerance32=2._real32*epsilon(1._real32)
real(real64)::tolerance64=2._real64*epsilon(1._real64)
real(real32),intent(in),optional::tolerance32
real(real64),intent(in),optional::tolerance64
logical,intent(in),optional::errorstop
logical::do_errorstop
integer(int8),intent(in)::i1
integer(int8),intent(in)::i2
logical,intent(in),optional::fail
integer(int16),intent(in)::i1
integer(int16),intent(in)::i2
logical,intent(in),optional::fail
integer(int32),intent(in)::i1
integer(int32),intent(in)::i2
logical,intent(in),optional::fail
integer(int64),intent(in)::i1
integer(int64),intent(in)::i2
logical,intent(in),optional::fail
real(real32),intent(in)::r1
real(real32),intent(in)::r2
logical,intent(in),optional::fail
real(real64),intent(in)::r1
real(real64),intent(in)::r2
logical,intent(in),optional::fail
complex(real32),intent(in)::c1
complex(real32),intent(in)::c2
logical,intent(in),optional::fail
complex(real64),intent(in)::c1
complex(real64),intent(in)::c2
logical,intent(in),optional::fail
logical,intent(in)::l1
logical,intent(in)::l2
logical,intent(in),optional::fail
integer(int8),dimension(:),intent(in)::i1
integer(int8),dimension(:),intent(in)::i2
logical,intent(in),optional::fail
integer(int16),dimension(:),intent(in)::i1
integer(int16),dimension(:),intent(in)::i2
logical,intent(in),optional::fail
integer(int32),dimension(:),intent(in)::i1
integer(int32),dimension(:),intent(in)::i2
logical,intent(in),optional::fail
integer(int64),dimension(:),intent(in)::i1
integer(int64),dimension(:),intent(in)::i2
logical,intent(in),optional::fail
real(real32),dimension(:),intent(in)::r1
real(real32),dimension(:),intent(in)::r2
logical,intent(in),optional::fail
real(real64),dimension(:),intent(in)::r1
real(real64),dimension(:),intent(in)::r2
logical,intent(in),optional::fail
complex(real32),dimension(:),intent(in)::c1
complex(real32),dimension(:),intent(in)::c2
logical,intent(in),optional::fail
complex(real64),dimension(:),intent(in)::c1
complex(real64),dimension(:),intent(in)::c2
logical,intent(in),optional::fail
logical,intent(in),dimension(:)::l1
logical,intent(in),dimension(:)::l2
logical,intent(in),optional::fail
integer::k
integer(int8),intent(in)::i
logical,intent(in),optional::fail
integer(int16),intent(in)::i
logical,intent(in),optional::fail
integer(int32),intent(in)::i
logical,intent(in),optional::fail
integer(int64),intent(in)::i
logical,intent(in),optional::fail
real(real32),intent(in)::r
logical,intent(in),optional::fail
real(real64),intent(in)::r
logical,intent(in),optional::fail
integer(int8),dimension(:),intent(in)::i
logical,intent(in),optional::fail
integer(int16),dimension(:),intent(in)::i
logical,intent(in),optional::fail
integer(int32),dimension(:),intent(in)::i
logical,intent(in),optional::fail
integer(int64),dimension(:),intent(in)::i
logical,intent(in),optional::fail
real(real32),dimension(:),intent(in)::r
logical,intent(in),optional::fail
real(real64),dimension(:),intent(in)::r
logical,intent(in),optional::fail
real(real32),intent(in)::r1
real(real32),intent(in)::r2
logical,intent(in),optional::fail
real(real64),intent(in)::r1
real(real64),intent(in)::r2
logical,intent(in),optional::fail
real(real32),intent(in),dimension(:)::r1
real(real32),intent(in),dimension(:)::r2
logical,intent(in),optional::fail
real(real64),intent(in),dimension(:)::r1
real(real64),intent(in),dimension(:)::r2
logical,intent(in),optional::fail
complex(real32),intent(in)::c1
complex(real32),intent(in)::c2
logical,intent(in),optional::fail
complex(real64),intent(in)::r1
complex(real64),intent(in)::c2
logical,intent(in),optional::fail
complex(real32),intent(in),dimension(:)::c1
complex(real32),intent(in),dimension(:)::c2
logical,intent(in),optional::fail
complex(real64),intent(in),dimension(:)::c1
complex(real64),intent(in),dimension(:)::c2
logical,intent(in),optional::fail
TYPE(tester_t)::test
INTEGER::itottests,itoterr,ierr,me
INTEGER::ierr
INTEGER::ldx,ldy,n,m,what
REAL(DP)::x(ldx,m),y(ldy,n)
INTEGER::i,j,k,d,nb,mb,ib,jb,ioff,joff
INTEGER::iind,jind
INTEGER,PARAMETER::bsiz=__BSIZ_VALUE
REAL(DP)::buf(bsiz,bsiz),bswp
INTEGER::ldx,ldy,n,m,what
COMPLEX(DP)::x(ldx,m),y(ldy,n)
INTEGER::i,j,k,d,nb,mb,ib,jb,ioff,joff
INTEGER::iind,jind
INTEGER,PARAMETER::bsiz=__BSIZ_VALUE/2
COMPLEX(DP)::buf(bsiz,bsiz),bswp
INTEGER::ldx,ldy,n,m,what
REAL(SP)::x(ldx,m),y(ldy,n)
INTEGER::i,j,k,d,nb,mb,ib,jb,ioff,joff
INTEGER::iind,jind
INTEGER,PARAMETER::bsiz=__BSIZ_VALUE
REAL(SP)::buf(bsiz,bsiz),bswp
INTEGER,PARAMETER::opt_zgemv=40
INTEGER,PARAMETER::opt_zgerc=40
INTEGER::I,IINFO,J,K,JL,KL,J1,I1,I2,NI1,L,IERR
INTEGER::ibeg,iend,nr
INTEGER::QI,KL,INFO
INTEGER::IL(N+1)
INTEGER::OW(N+1)
REAL(DP)::WORK(2*N)
REAL(DP)::dvar(6)
LOGICAL,INTENT(IN)::tv
INTEGER,INTENT(IN)::nb,n,ortho_cntx,ortho_comm
COMPLEX(DP)::h(:,:)
REAL(DP)::w(:)
COMPLEX(DP)::ztmp(4)
REAL(DP)::rtmp(4)
INTEGER::itmp(4),ldw
COMPLEX(DP),ALLOCATABLE::work(:)
COMPLEX(DP),ALLOCATABLE::v(:,:)
REAL(DP),ALLOCATABLE::rwork(:)
INTEGER,ALLOCATABLE::iwork(:)
INTEGER::LWORK,LRWORK,LIWORK
INTEGER::desch(10),info,ierr
CHARACTER::jobv
INTEGER::nprow,npcol,my_prow,my_pcol,mpi_comm_rows,mpi_comm_cols
LOGICAL::success
CHARACTER::JOBZ,UPLO
INTEGER::IOPT,INFO,LDZ,N
COMPLEX(DP)::AP(*),Z(LDZ,*)
REAL(DP)::W(*)
REAL(DP),ALLOCATABLE::RWORK(:)
COMPLEX(DP),ALLOCATABLE::ZWORK(:)
CHARACTER::JOBZ
INTEGER,INTENT(IN)::lda,ldz,nrl,n,nproc,mpime
INTEGER,INTENT(IN)::comm
COMPLEX(DP)::ap(lda,*),z(ldz,*)
REAL(DP)::w(*)
REAL(DP),ALLOCATABLE::rwork(:)
COMPLEX(DP),ALLOCATABLE::cwork(:)
INTEGER,INTENT(IN)::n,m,ldh
REAL(DP),INTENT(INOUT)::h(ldh,n),s(ldh,n)
REAL(DP),INTENT(OUT)::e(n)
REAL(DP),INTENT(OUT)::v(ldh,m)
INTEGER,INTENT(IN)::me_bgrp,root_bgrp,intra_bgrp_comm
INTEGER::lwork,nb,mm,info,i,j
REAL(DP)::abstol
REAL(DP),PARAMETER::one=1_DP
REAL(DP),PARAMETER::zero=0_DP
INTEGER,ALLOCATABLE::iwork(:),ifail(:)
REAL(DP),ALLOCATABLE::work(:),sdiag(:),hdiag(:)
LOGICAL::all_eigenvalues
INTEGER,INTENT(IN)::n,m,ldh
REAL(DP),INTENT(INOUT)::h_d(ldh,n),s_d(ldh,n)
REAL(DP),INTENT(OUT)::e_d(n)
REAL(DP),INTENT(OUT)::v_d(ldh,n)
INTEGER,INTENT(IN)::me_bgrp,root_bgrp,intra_bgrp_comm
INTEGER::lwork,nb,mm,info,i,j
REAL(DP)::abstol
REAL(DP),PARAMETER::one=1_DP
REAL(DP),PARAMETER::zero=0_DP
INTEGER,ALLOCATABLE::iwork(:),ifail(:)
REAL(DP),ALLOCATABLE::work(:),sdiag(:),hdiag(:)
REAL(DP),ALLOCATABLE::v_h(:,:)
REAL(DP),ALLOCATABLE::e_h(:)
INTEGER::lwork_d,liwork
REAL(DP),VARTYPE::work_d(:)
REAL(DP),ALLOCATABLE::h_diag_d(:),s_diag_d(:)
INTEGER::devInfo_d,h_meig
TYPE(cusolverDnHandle)::cuSolverHandle
REAL(DP),VARTYPE::h_bkp_d(:,:),s_bkp_d(:,:)
INTEGER,INTENT(IN)::n,ldh
REAL(DP),INTENT(INOUT)::h(ldh,ldh),s(ldh,ldh)
REAL(DP),INTENT(OUT)::e(n)
REAL(DP),INTENT(OUT)::v(ldh,ldh)
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
INTEGER,PARAMETER::root=0
INTEGER::nx,info
REAL(DP),PARAMETER::one=1_DP
REAL(DP),PARAMETER::zero=0_DP
REAL(DP),ALLOCATABLE::hh(:,:)
REAL(DP),ALLOCATABLE::ss(:,:)
TYPE(la_descriptor)::desc
INTEGER::desch(16)
INTEGER::i
INTEGER,INTENT(IN)::na
INTEGER,INTENT(IN)::lda
REAL(DP)::a(lda,lda)
TYPE(la_descriptor),INTENT(IN)::desca
INTEGER,INTENT(IN)::nb
INTEGER,INTENT(IN)::ldb
REAL(DP)::b(ldb,ldb)
TYPE(la_descriptor),INTENT(IN)::descb
INTEGER::ipc,ipr,npc,npr
INTEGER::ipr_old,ir_old,nr_old,irx_old
INTEGER::ipc_old,ic_old,nc_old,icx_old
INTEGER::myrow,mycol,ierr,rank
INTEGER::col_comm,row_comm,comm,sreq
INTEGER::nr_new,ir_new,irx_new,ir,nr,nrtot,irb,ire
INTEGER::nc_new,ic_new,icx_new,ic,nc,nctot,icb,ice
INTEGER::ib,i,j,myid
INTEGER::nrsnd(desca%npr)
INTEGER::ncsnd(desca%npr)
INTEGER::displ(desca%npr)
INTEGER::irb_new(desca%npr)
INTEGER::ire_new(desca%npr)
INTEGER::icb_new(desca%npr)
INTEGER::ice_new(desca%npr)
REAL(DP),ALLOCATABLE::buf(:)
REAL(DP),ALLOCATABLE::ab(:,:)
REAL(DP),ALLOCATABLE::tst1(:,:)
REAL(DP),ALLOCATABLE::tst2(:,:)
INTEGER::istatus(MPI_STATUS_SIZE)
INTEGER,INTENT(IN)::na
INTEGER,INTENT(IN)::lda
COMPLEX(DP)::a(lda,lda)
TYPE(la_descriptor),INTENT(IN)::desca
INTEGER,INTENT(IN)::nb
INTEGER,INTENT(IN)::ldb
COMPLEX(DP)::b(ldb,ldb)
TYPE(la_descriptor),INTENT(IN)::descb
INTEGER::ipc,ipr,npc,npr
INTEGER::ipr_old,ir_old,nr_old,irx_old
INTEGER::ipc_old,ic_old,nc_old,icx_old
INTEGER::myrow,mycol,ierr,rank
INTEGER::col_comm,row_comm,comm,sreq
INTEGER::nr_new,ir_new,irx_new,ir,nr,nrtot,irb,ire
INTEGER::nc_new,ic_new,icx_new,ic,nc,nctot,icb,ice
INTEGER::ib,i,j,myid
INTEGER::nrsnd(desca%npr)
INTEGER::ncsnd(desca%npr)
INTEGER::displ(desca%npr)
INTEGER::irb_new(desca%npr)
INTEGER::ire_new(desca%npr)
INTEGER::icb_new(desca%npr)
INTEGER::ice_new(desca%npr)
COMPLEX(DP),ALLOCATABLE::buf(:)
COMPLEX(DP),ALLOCATABLE::ab(:,:)
COMPLEX(DP),ALLOCATABLE::tst1(:,:)
COMPLEX(DP),ALLOCATABLE::tst2(:,:)
INTEGER::istatus(MPI_STATUS_SIZE)
INTEGER,INTENT(IN)::n
INTEGER,INTENT(IN)::ldar
REAL(DP)::ar(ldar,*)
INTEGER,INTENT(IN)::lda
REAL(DP)::a(lda,*)
TYPE(la_descriptor),INTENT(IN)::desc
REAL(DP),PARAMETER::zero=0_DP
INTEGER::i,j,nr,nc,ic,ir,nx
INTEGER,INTENT(IN)::n
INTEGER,INTENT(IN)::ldar
COMPLEX(DP)::ar(ldar,*)
INTEGER,INTENT(IN)::lda
COMPLEX(DP)::a(lda,*)
TYPE(la_descriptor),INTENT(IN)::desc
COMPLEX(DP),PARAMETER::zero=(0_DP,0_DP)
INTEGER::i,j,nr,nc,ic,ir,nx
INTEGER,INTENT(IN)::n
INTEGER,INTENT(IN)::ldar
REAL(DP)::ar(ldar,*)
INTEGER,INTENT(IN)::lda
REAL(DP)::a(lda,*)
TYPE(la_descriptor),INTENT(IN)::desc
INTEGER,INTENT(IN)::comm
INTEGER::i,j
INTEGER::np,nx,ipc,ipr,npr,npc,noff
INTEGER::ierr,ir,ic,nr,nc
REAL(DP),ALLOCATABLE::buf(:,:)
INTEGER,INTENT(IN)::n
INTEGER,INTENT(IN)::ldar
COMPLEX(DP)::ar(ldar,*)
INTEGER,INTENT(IN)::lda
COMPLEX(DP)::a(lda,*)
TYPE(la_descriptor),INTENT(IN)::desc
INTEGER,INTENT(IN)::comm
INTEGER::i,j
INTEGER::np,nx,ipc,ipr,npr,npc,noff
INTEGER::ierr,ir,ic,nr,nc
COMPLEX(DP),ALLOCATABLE::buf(:,:)
INTEGER,INTENT(IN)::n
INTEGER,INTENT(IN)::lda
REAL(DP)::a(lda,*)
TYPE(la_descriptor),INTENT(IN)::desc
INTEGER::i,j
INTEGER,INTENT(IN)::n
INTEGER,INTENT(IN)::lda
REAL(DP)::a(lda,*)
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
TYPE(la_descriptor)::desc
INTEGER::istatus(MPI_STATUS_SIZE)
INTEGER::i,j
INTEGER::comm
INTEGER::nr,nc,dest,sreq,ierr,sour
REAL(DP)::atmp
INTEGER,INTENT(IN)::n
INTEGER,INTENT(IN)::lda
REAL(DP),INTENT(INOUT),DEVICE::a(:,:)
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
TYPE(la_descriptor)::desc
INTEGER::istatus(MPI_STATUS_SIZE)
REAL(DP),ALLOCATABLE::a_h(:,:)
INTEGER::i,j
INTEGER::comm
INTEGER::nr,nc,dest,sreq,ierr,sour
REAL(DP)::atmp
INTEGER,INTENT(IN)::n
INTEGER,INTENT(IN)::lda
COMPLEX(DP)::a(lda,lda)
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
TYPE(la_descriptor)::desc
INTEGER::istatus(MPI_STATUS_SIZE)
INTEGER::i,j
INTEGER::comm,myid
INTEGER::nr,nc,dest,sreq,ierr,sour
COMPLEX(DP)::atmp
COMPLEX(DP),ALLOCATABLE::tst1(:,:)
COMPLEX(DP),ALLOCATABLE::tst2(:,:)
INTEGER,INTENT(IN)::na
INTEGER,INTENT(IN)::lda
REAL(DP)::a(lda,lda)
INTEGER,INTENT(IN)::idesca(LAX_DESC_SIZE)
INTEGER,INTENT(IN)::nb
INTEGER,INTENT(IN)::ldb
REAL(DP)::b(ldb,ldb)
INTEGER,INTENT(IN)::idescb(LAX_DESC_SIZE)
TYPE(la_descriptor)::desca
TYPE(la_descriptor)::descb
INTEGER,INTENT(IN)::na
INTEGER,INTENT(IN)::lda
COMPLEX(DP)::a(lda,lda)
INTEGER,INTENT(IN)::idesca(LAX_DESC_SIZE)
INTEGER,INTENT(IN)::nb
INTEGER,INTENT(IN)::ldb
COMPLEX(DP)::b(ldb,ldb)
INTEGER,INTENT(IN)::idescb(LAX_DESC_SIZE)
TYPE(la_descriptor)::desca
TYPE(la_descriptor)::descb
CHARACTER(LEN=1),INTENT(IN)::transa,transb
INTEGER,INTENT(IN)::m,n,k
REAL(DP),INTENT(IN)::alpha,beta
INTEGER,INTENT(IN)::lda,ldb,ldc
REAL(DP)::a(lda,*),b(ldb,*),c(ldc,*)
INTEGER,INTENT(IN)::comm
INTEGER::ME,I,II,J,JJ,IP,SOUR,DEST,INFO,IERR,ioff,ldx
INTEGER::NB,IB_S,NB_SOUR,IB_SOUR,IBUF
INTEGER::nproc,mpime,q,r
REAL(DP),ALLOCATABLE::auxa(:)
REAL(DP),ALLOCATABLE::auxc(:)
CHARACTER(LEN=1),INTENT(IN)::transa,transb
INTEGER,INTENT(IN)::m,n,k
COMPLEX(DP),INTENT(IN)::alpha,beta
INTEGER,INTENT(IN)::lda,ldb,ldc
COMPLEX(DP)::a(lda,*),b(ldb,*),c(ldc,*)
INTEGER,INTENT(IN)::comm
INTEGER::ME,I,II,J,JJ,IP,SOUR,DEST,INFO,IERR,ioff,ldx
INTEGER::NB,IB_S,NB_SOUR,IB_SOUR,IBUF
INTEGER::nproc,mpime,q,r
COMPLEX(DP),ALLOCATABLE::auxa(:)
COMPLEX(DP),ALLOCATABLE::auxc(:)
CHARACTER(LEN=1),INTENT(IN)::transa,transb
INTEGER,INTENT(IN)::n
REAL(DP),INTENT(IN)::alpha,beta
INTEGER,INTENT(IN)::lda,ldb,ldc
REAL(DP)::a(lda,*),b(ldb,*),c(ldc,*)
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
TYPE(la_descriptor)::desc
integer::ierr
integer::np
integer::i,j,nr,nc,nb,iter,rowid,colid
logical::ta,tb
INTEGER::comm
real(DP),allocatable::bblk(:,:),ablk(:,:)
integer::istatus(MPI_STATUS_SIZE)
REAL(DP)::blk(:,:)
CHARACTER(LEN=1),INTENT(IN)::dir
INTEGER,INTENT(IN)::ln
INTEGER,INTENT(IN)::tag
INTEGER::icdst,irdst,icsrc,irsrc,idest,isour
REAL(DP)::blk(:,:)
CHARACTER(LEN=1),INTENT(IN)::dir
INTEGER,INTENT(IN)::tag
INTEGER::icdst,irdst,icsrc,irsrc,idest,isour
INTEGER::icol,irow
CHARACTER(LEN=1),INTENT(IN)::transa,transb
INTEGER,INTENT(IN)::n
REAL(DP),INTENT(IN)::alpha,beta
INTEGER,INTENT(IN)::lda,ldb,ldc
REAL(DP),DEVICE::a(:,:),b(:,:),c(:,:)
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
TYPE(la_descriptor)::desc
integer::ierr
integer::np
integer::i,j,nr,nc,nb,iter,rowid,colid
logical::ta,tb
INTEGER::comm
real(DP),DEVICE,allocatable::bblk(:,:),ablk(:,:)
integer::istatus(MPI_STATUS_SIZE)
REAL(DP),DEVICE::blk(:,:)
CHARACTER(LEN=1),INTENT(IN)::dir
INTEGER,INTENT(IN)::ln
INTEGER,INTENT(IN)::tag
INTEGER::icdst,irdst,icsrc,irsrc,idest,isour
REAL(DP),ALLOCATABLE::blk_h(:,:)
REAL(DP),DEVICE::blk(:,:)
CHARACTER(LEN=1),INTENT(IN)::dir
INTEGER,INTENT(IN)::tag
INTEGER::icdst,irdst,icsrc,irsrc,idest,isour
INTEGER::icol,irow
REAL(DP),ALLOCATABLE::blk_h(:,:)
CHARACTER(LEN=1),INTENT(IN)::transa,transb
INTEGER,INTENT(IN)::n
REAL(SP),INTENT(IN)::alpha,beta
INTEGER,INTENT(IN)::lda,ldb,ldc
REAL(SP)::a(lda,*),b(ldb,*),c(ldc,*)
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
TYPE(la_descriptor)::desc
integer::ierr
integer::np
integer::i,j,nr,nc,nb,iter,rowid,colid
logical::ta,tb
INTEGER::comm
real(SP),allocatable::bblk(:,:),ablk(:,:)
integer::istatus(MPI_STATUS_SIZE)
REAL(SP)::blk(:,:)
CHARACTER(LEN=1),INTENT(IN)::dir
INTEGER,INTENT(IN)::ln
INTEGER,INTENT(IN)::tag
INTEGER::icdst,irdst,icsrc,irsrc,idest,isour
REAL(SP)::blk(:,:)
CHARACTER(LEN=1),INTENT(IN)::dir
INTEGER,INTENT(IN)::tag
INTEGER::icdst,irdst,icsrc,irsrc,idest,isour
INTEGER::icol,irow
CHARACTER(LEN=1),INTENT(IN)::transa,transb
INTEGER,INTENT(IN)::n
COMPLEX(DP),INTENT(IN)::alpha,beta
INTEGER,INTENT(IN)::lda,ldb,ldc
COMPLEX(DP)::a(lda,*),b(ldb,*),c(ldc,*)
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
TYPE(la_descriptor)::desc
INTEGER::ierr
INTEGER::np
INTEGER::i,j,nr,nc,nb,iter,rowid,colid
LOGICAL::ta,tb
INTEGER::comm
COMPLEX(DP),ALLOCATABLE::bblk(:,:),ablk(:,:)
COMPLEX(DP)::zone=(1.0_DP,0.0_DP)
COMPLEX(DP)::zzero=(0.0_DP,0.0_DP)
integer::istatus(MPI_STATUS_SIZE)
COMPLEX(DP)::blk(:,:)
CHARACTER(LEN=1),INTENT(IN)::dir
INTEGER,INTENT(IN)::ln
INTEGER,INTENT(IN)::tag
INTEGER::icdst,irdst,icsrc,irsrc,idest,isour
COMPLEX(DP)::blk(:,:)
CHARACTER(LEN=1),INTENT(IN)::dir
INTEGER,INTENT(IN)::tag
INTEGER::icdst,irdst,icsrc,irsrc,idest,isour
INTEGER::icol,irow
INTEGER,INTENT(IN)::n
INTEGER,INTENT(IN)::lda,ldb
REAL(DP)::a(lda,*),b(ldb,*)
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
INTEGER::ierr
INTEGER::np,rowid,colid
INTEGER::i,j,nr,nc,nb
INTEGER::comm
REAL(DP),ALLOCATABLE::ablk(:,:)
INTEGER::istatus(MPI_STATUS_SIZE)
REAL(DP)::blk(:,:)
INTEGER::icdst,irdst,icsrc,irsrc,idest,isour
INTEGER,INTENT(IN)::n
INTEGER,INTENT(IN)::lda,ldb
REAL(DP),INTENT(IN),DEVICE::a(:,:)
REAL(DP),INTENT(OUT),DEVICE::b(:,:)
INTEGER,INTENT(IN)::idesc(:)
INTEGER::ierr
INTEGER::np,rowid,colid
INTEGER::i,j,nr,nc,nb,ldx
INTEGER::comm
REAL(DP)::tmp
REAL(DP),ALLOCATABLE,DEVICE::ablk(:,:)
REAL(DP),ALLOCATABLE::ablk(:,:)
INTEGER::istatus(MPI_STATUS_SIZE)
REAL(DP),DEVICE::blk(:,:)
REAL(DP)::blk(:,:)
INTEGER::icdst,irdst,icsrc,irsrc,idest,isour
INTEGER,INTENT(IN)::n
INTEGER,INTENT(IN)::lda,ldb
REAL(SP)::a(lda,*),b(ldb,*)
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
INTEGER::ierr
INTEGER::np,rowid,colid
INTEGER::i,j,nr,nc,nb
INTEGER::comm
REAL(SP),ALLOCATABLE::ablk(:,:)
INTEGER::istatus(MPI_STATUS_SIZE)
REAL(SP)::blk(:,:)
INTEGER::icdst,irdst,icsrc,irsrc,idest,isour
INTEGER,INTENT(IN)::n
INTEGER,INTENT(IN)::ldx,nx
REAL(DP)::a(ldx,nx),b(ldx,nx)
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
INTEGER::ierr
INTEGER::np,rowid,colid
INTEGER::comm
INTEGER::icdst,irdst,icsrc,irsrc,idest,isour
INTEGER::istatus(MPI_STATUS_SIZE)
INTEGER,INTENT(IN)::n
INTEGER,INTENT(IN)::ldx,nx
REAL(DP),DEVICE::a(:,:)
REAL(DP),DEVICE::b(:,:)
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
REAL(DP),ALLOCATABLE::a_h(:,:),b_h(:,:)
INTEGER::ierr
INTEGER::np,rowid,colid
INTEGER::comm
INTEGER::icdst,irdst,icsrc,irsrc,idest,isour
INTEGER::istatus(MPI_STATUS_SIZE)
INTEGER,INTENT(IN)::n
INTEGER,INTENT(IN)::lda,nca,ldb,ncb
REAL(DP)::a(lda,nca),b(ldb,ncb)
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
TYPE(la_descriptor)::desc
integer::ierr,itag
integer::np,ip,me,nproc,comm_a
integer::ip_ir,ip_ic,ip_nr,ip_nc,il,nbuf,ip_irl
integer::i,ii,j,jj,nr,nc,nb,nrl,irl,ir,ic
INTEGER::me_ortho(2),np_ortho(2)
real(DP),allocatable::rcvbuf(:,:,:)
real(DP),allocatable::sndbuf(:,:)
TYPE(la_descriptor)::ip_desc
character(len=256)::msg
CHARACTER(LEN=38),SAVE::msg='check_sndbuf_indexincyc2blk_redist'
CHARACTER(LEN=38),SAVE::msg='check_rcvbuf_indexincyc2blk_redist'
INTEGER,INTENT(IN)::n
INTEGER,INTENT(IN)::lda,nca,ldb,ncb
COMPLEX(DP)::a(lda,nca),b(ldb,ncb)
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
TYPE(la_descriptor)::desc
integer::ierr,itag
integer::np,ip,me,nproc,comm_a
integer::ip_ir,ip_ic,ip_nr,ip_nc,il,nbuf,ip_irl
integer::i,ii,j,jj,nr,nc,nb,nrl,irl,ir,ic
INTEGER::me_ortho(2),np_ortho(2)
COMPLEX(DP),allocatable::rcvbuf(:,:,:)
COMPLEX(DP),allocatable::sndbuf(:,:)
TYPE(la_descriptor)::ip_desc
character(len=256)::msg
CHARACTER(LEN=40),SAVE::msg='check_sndbuf_indexincyc2blk_zredist'
CHARACTER(LEN=40),SAVE::msg='check_rcvbuf_indexincyc2blk_zredist'
INTEGER,INTENT(IN)::n
INTEGER,INTENT(IN)::lda,nca,ldb,ncb
REAL(DP)::a(lda,nca),b(ldb,ncb)
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
TYPE(la_descriptor)::desc
integer::ierr,itag
integer::np,ip,me,comm_a,nproc
integer::ip_ir,ip_ic,ip_nr,ip_nc,il,nbuf,ip_irl
integer::i,ii,j,jj,nr,nc,nb,nrl,irl,ir,ic
INTEGER::me_ortho(2),np_ortho(2)
REAL(DP),allocatable::rcvbuf(:,:,:)
REAL(DP),allocatable::sndbuf(:,:)
TYPE(la_descriptor)::ip_desc
character(len=256)::msg
INTEGER,INTENT(IN)::n
INTEGER,INTENT(IN)::lda,nca,ldb,ncb
COMPLEX(DP)::a(lda,nca),b(ldb,ncb)
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
TYPE(la_descriptor)::desc
integer::ierr,itag
integer::np,ip,me,comm_a,nproc
integer::ip_ir,ip_ic,ip_nr,ip_nc,il,nbuf,ip_irl
integer::i,ii,j,jj,nr,nc,nb,nrl,irl,ir,ic
INTEGER::me_ortho(2),np_ortho(2)
COMPLEX(DP),allocatable::rcvbuf(:,:,:)
COMPLEX(DP),allocatable::sndbuf(:,:)
TYPE(la_descriptor)::ip_desc
character(len=256)::msg
integer::n,ldx
integer,INTENT(IN)::idesc(LAX_DESC_SIZE)
real(DP)::one,zero
complex(DP)::sll(ldx,ldx),cone,czero
integer::myrow,mycol,ierr
integer::jb,info,ib,kb
integer::jnr,jir,jic,jnc
integer::inr,iir,iic,inc
integer::knr,kir,kic,knc
integer::nr,nc
integer::rcomm,ccomm,color,key,myid,np
complex(DP),allocatable::ssnd(:,:),srcv(:,:)
TYPE(la_descriptor)::desc
integer::n,ldx
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
REAL(DP)::one,zero
REAL(DP)::sll(ldx,ldx)
integer::myrow,mycol,ierr
integer::jb,info,ib,kb
integer::jnr,jir,jic,jnc
integer::inr,iir,iic,inc
integer::knr,kir,kic,knc
integer::nr,nc
integer::rcomm,ccomm,color,key,myid,np
REAL(DP),ALLOCATABLE::ssnd(:,:),srcv(:,:)
TYPE(la_descriptor)::desc
INTEGER,INTENT(IN)::n,ldx
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
COMPLEX(DP),INTENT(INOUT)::sll(ldx,ldx)
COMPLEX(DP),PARAMETER::ONE=(1.0_DP,0.0_DP)
COMPLEX(DP),PARAMETER::ZERO=(0.0_DP,0.0_DP)
INTEGER::status(MPI_STATUS_SIZE)
INTEGER::req(2),ierr,col_comm
INTEGER::send,recv,group_rank,group_size
INTEGER::myrow,mycol,np,myid,comm
INTEGER::k,i,j,count,step_count,shiftcount,cicle
INTEGER::C3dim
INTEGER::nc,nr
INTEGER::info,sup_recv
INTEGER::idrowref,idcolref,idref,idrecv
COMPLEX(DP),ALLOCATABLE,DIMENSION(:,:)::B,C,BUF_RECV
COMPLEX(DP)::first
TYPE(la_descriptor)::desc
INTEGER::idref,id,pos,size
CHARACTER(LEN=1)::dir
INTEGER,INTENT(IN)::n,ldx
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
REAL(DP),INTENT(INOUT)::sll(ldx,ldx)
REAL(DP),PARAMETER::ONE=1.0_DP
REAL(DP),PARAMETER::ZERO=0.0_DP
INTEGER::status(MPI_STATUS_SIZE)
INTEGER::req(2),ierr,col_comm
INTEGER::send,recv,group_rank,group_size
INTEGER::myrow,mycol,np,myid,comm
INTEGER::k,i,j,count,step_count,shiftcount,cicle
INTEGER::C3dim
INTEGER::nc,nr
INTEGER::info,sup_recv
INTEGER::idrowref,idcolref,idref,idrecv
REAL(DP),ALLOCATABLE,DIMENSION(:,:)::B,C,BUF_RECV
REAL(DP)::first
TYPE(la_descriptor)::desc
INTEGER::idref,id,pos,size
CHARACTER(LEN=1)::dir
LOGICAL,INTENT(IN)::tv
INTEGER,INTENT(IN)::n,ldh
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
REAL(DP)::hh(ldh,ldh)
REAL(DP)::e(n)
INTEGER::nrlx,nrl,nproc
REAL(DP),ALLOCATABLE::diag(:,:),vv(:,:)
CHARACTER::jobv
LOGICAL,INTENT(IN)::tv
INTEGER,INTENT(IN)::n,ldh
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
COMPLEX(DP)::hh(ldh,ldh)
REAL(DP)::e(n)
INTEGER::nrlx,nrl
COMPLEX(DP),ALLOCATABLE::diag(:,:),vv(:,:)
CHARACTER::jobv
CHARACTER(LEN=1),INTENT(IN)::what
INTEGER,INTENT(IN)::n
REAL(DP),INTENT(IN)::alpha
INTEGER,INTENT(IN)::lda
REAL(DP)::a(lda,*)
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
INTEGER::i,j
CHARACTER(LEN=1),INTENT(IN)::what
INTEGER,INTENT(IN)::n
COMPLEX(DP),INTENT(IN)::alpha
INTEGER,INTENT(IN)::lda
COMPLEX(DP)::a(lda,*)
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
INTEGER::i,j
REAL(DP),INTENT(IN)::lambda_repl(:,:)
REAL(DP),INTENT(OUT)::lambda_dist(:,:)
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
INTEGER::i,j,ic,ir
REAL(DP),INTENT(OUT)::lambda_repl(:,:)
REAL(DP),INTENT(IN)::lambda_dist(:,:)
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
INTEGER::i,j,ic,ir,ierr
REAL(DP),INTENT(OUT)::zmat_repl(:,:)
REAL(DP),INTENT(IN)::zmat_dist(:,:)
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
INTEGER::i,ii,j,me,np,nrl,ierr
REAL(DP),INTENT(OUT)::lambda_dist(:,:)
INTEGER,INTENT(IN)::i,j
REAL(DP),INTENT(IN)::val
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
INTEGER::ir,ic
REAL(DP),INTENT(IN)::zmat_repl(:,:)
REAL(DP),INTENT(OUT)::zmat_dist(:,:)
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
INTEGER::i,ii,j,me,np
INTEGER,INTENT(IN)::n,m,ldh
COMPLEX(DP),INTENT(INOUT)::h(ldh,n),s(ldh,n)
REAL(DP),INTENT(OUT)::e(n)
COMPLEX(DP),INTENT(OUT)::v(ldh,m)
INTEGER,INTENT(IN)::me_bgrp,root_bgrp,intra_bgrp_comm
INTEGER::lwork,nb,mm,info,i,j
REAL(DP)::abstol
INTEGER,ALLOCATABLE::iwork(:),ifail(:)
REAL(DP),ALLOCATABLE::rwork(:),sdiag(:),hdiag(:)
COMPLEX(DP),ALLOCATABLE::work(:)
LOGICAL::all_eigenvalues
INTEGER,INTENT(IN)::n,m,ldh
COMPLEX(DP),INTENT(INOUT)::h_d(ldh,n),s_d(ldh,n)
REAL(DP),INTENT(OUT)::e_d(n)
COMPLEX(DP),INTENT(OUT)::v_d(ldh,n)
INTEGER,INTENT(IN)::me_bgrp,root_bgrp,intra_bgrp_comm
INTEGER::lwork,info
REAL(DP)::abstol
INTEGER,ALLOCATABLE::ifail(:)
INTEGER,VARTYPE::iwork(:)
REAL(DP),VARTYPE::rwork(:)
COMPLEX(DP),VARTYPE::work(:)
COMPLEX(DP),VARTYPE::v_h(:,:)
REAL(DP),VARTYPE::e_h(:)
INTEGER::lwork_d,lrwork_d,liwork,lrwork
REAL(DP),VARTYPE::rwork_d(:)
COMPLEX(DP),VARTYPE::work_d(:)
REAL(DP),VARTYPE::h_diag_d(:),s_diag_d(:)
INTEGER::i,j
INTEGER::devInfo_d,h_meig
TYPE(cusolverDnHandle)::cuSolverHandle
COMPLEX(DP),VARTYPE::h_bkp_d(:,:),s_bkp_d(:,:)
INTEGER,INTENT(IN)::n,ldh
COMPLEX(DP),INTENT(INOUT)::h(ldh,ldh),s(ldh,ldh)
REAL(DP),INTENT(OUT)::e(n)
COMPLEX(DP),INTENT(OUT)::v(ldh,ldh)
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
TYPE(la_descriptor)::desc
INTEGER,PARAMETER::root=0
INTEGER::nx,info
INTEGER::descsca(16)
COMPLEX(DP),ALLOCATABLE::ss(:,:),hh(:,:),tt(:,:)
INTEGER::i,j,k
COMPLEX(DP),ALLOCATABLE::diag(:,:)
INTEGER,OPTIONAL,INTENT(OUT)::nproc_ortho
INTEGER,OPTIONAL,INTENT(OUT)::leg_ortho
INTEGER,OPTIONAL,INTENT(OUT)::np_ortho(2)
INTEGER,OPTIONAL,INTENT(OUT)::me_ortho(2)
INTEGER,OPTIONAL,INTENT(OUT)::ortho_comm
INTEGER,OPTIONAL,INTENT(OUT)::ortho_row_comm
INTEGER,OPTIONAL,INTENT(OUT)::ortho_col_comm
INTEGER,OPTIONAL,INTENT(OUT)::ortho_comm_id
INTEGER,OPTIONAL,INTENT(OUT)::ortho_parent_comm
INTEGER,OPTIONAL,INTENT(OUT)::me_blacs
INTEGER,OPTIONAL,INTENT(OUT)::np_blacs
INTEGER,OPTIONAL,INTENT(OUT)::ortho_cntx
INTEGER,OPTIONAL,INTENT(OUT)::world_cntx
LOGICAL,OPTIONAL,INTENT(OUT)::do_distr_diag_inside_bgrp
INTEGER,INTENT(OUT)::LAX_STATUS(:)
INTEGER,INTENT(INOUT)::ndiag_
INTEGER,INTENT(IN)::my_world_comm
INTEGER,INTENT(IN)::parent_comm
LOGICAL,INTENT(IN)::do_distr_diag_inside_bgrp_
INTEGER::nproc_ortho_try
INTEGER::parent_nproc
INTEGER::world_nproc
INTEGER::my_parent_id
INTEGER::nparent_comm
INTEGER::ierr=0
INTEGER,INTENT(IN)::nproc_try_in,comm_all
INTEGER,INTENT(IN)::my_world_comm
INTEGER,INTENT(IN)::nparent_comm
INTEGER,INTENT(IN)::my_parent_id
INTEGER::ierr,color,key,me_all,nproc_all,nproc_try
INTEGER,ALLOCATABLE::blacsmap(:,:)
INTEGER,ALLOCATABLE::ortho_cntx_pe(:)
INTEGER::nprow,npcol,myrow,mycol,i,j,k
real(DP),intent(in)::lambda(:,:,:),ccc
INTEGER,INTENT(IN)::idesc(:,:)
integer,intent(in)::n,nshow,nudx
logical,intent(in)::ionode
integer,intent(in)::iunit
integer::nnn,j,i,is
real(DP),allocatable::lambda_repl(:,:)
INTEGER,INTENT(IN)::nsiz
INTEGER,INTENT(OUT)::nx
LOGICAL,INTENT(OUT)::la_proc
INTEGER,INTENT(OUT)::idesc(LAX_DESC_SIZE)
INTEGER,INTENT(OUT),ALLOCATABLE::rank_ip(:,:)
INTEGER,INTENT(OUT),ALLOCATABLE::idesc_ip(:,:,:)
INTEGER::ortho_comm,np_ortho(2),me_ortho(2),ortho_comm_id,&
INTEGER,INTENT(IN)::nsiz
INTEGER,INTENT(OUT)::nx
LOGICAL,INTENT(OUT)::la_proc
INTEGER,INTENT(OUT)::idesc(LAX_DESC_SIZE)
INTEGER,INTENT(OUT),ALLOCATABLE::rank_ip(:,:)
INTEGER,INTENT(OUT),ALLOCATABLE::irc_ip(:)
INTEGER,INTENT(OUT),ALLOCATABLE::nrc_ip(:)
INTEGER::i,j,rank
INTEGER::ortho_comm,np_ortho(2),me_ortho(2),ortho_comm_id,&
INTEGER,INTENT(OUT)::idesc(LAX_DESC_SIZE)
INTEGER,INTENT(IN)::n
INTEGER,INTENT(IN)::nx
INTEGER,INTENT(IN)::np(2),me(2),comm,cntx
INTEGER,INTENT(IN)::comm_id
TYPE(la_descriptor)::descla
INTEGER,INTENT(OUT)::idesc(LAX_DESC_SIZE)
INTEGER,INTENT(OUT)::idesc_ip(:,:,:)
INTEGER,INTENT(OUT)::rank_ip(:,:)
INTEGER,INTENT(IN)::n
INTEGER,INTENT(IN)::nx
INTEGER::i,j,rank,includeme
INTEGER::coor_ip(2)
TYPE(la_descriptor)::descla
INTEGER,INTENT(OUT)::i2g
INTEGER,INTENT(OUT)::nl
INTEGER,INTENT(IN)::n
INTEGER,INTENT(IN)::nx
INTEGER,INTENT(IN)::np
INTEGER,INTENT(IN)::me
REAL(DP),INTENT(IN)::rhos(:,:)
REAL(DP)::rhod(:)
REAL(DP)::s(:,:)
INTEGER,INTENT(IN)::n
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
INTEGER,INTENT(IN)::n
REAL(DP)::rhos(:,:)
REAL(DP)::rhod(:)
REAL(DP),ALLOCATABLE::aux(:)
INTEGER::i,j,k
INTEGER,INTENT(IN)::m
REAL(DP),DEVICE,INTENT(IN)::rhos(:,:)
REAL(DP),DEVICE,INTENT(OUT)::rhod(:)
REAL(DP),DEVICE,INTENT(OUT)::s(:,:)
INTEGER,INTENT(OUT)::info
INTEGER::lwork_d
INTEGER::i,j,lda
INTEGER,DEVICE::devInfo
TYPE(cusolverDnHandle)::cuSolverHandle
REAL(DP),ALLOCATABLE,DEVICE::work_d(:)
REAL(DP),ALLOCATABLE::work_d(:),a(:,:)
REAL(DP),ALLOCATABLE::b(:,:)
REAL(DP),ALLOCATABLE::work_h(:),w_h(:),z_h(:,:)
INTEGER,ALLOCATABLE::iwork_h(:)
INTEGER::lwork_h,liwork_h
INTEGER,INTENT(INOUT)::ndiag_
INTEGER,INTENT(IN)::my_world_comm
INTEGER,INTENT(IN)::parent_comm
LOGICAL,INTENT(IN)::do_distr_diag_inside_bgrp_
INTEGER,OPTIONAL,INTENT(OUT)::nproc_ortho
INTEGER,OPTIONAL,INTENT(OUT)::leg_ortho
INTEGER,OPTIONAL,INTENT(OUT)::np_ortho(2)
INTEGER,OPTIONAL,INTENT(OUT)::me_ortho(2)
INTEGER,OPTIONAL,INTENT(OUT)::ortho_comm
INTEGER,OPTIONAL,INTENT(OUT)::ortho_row_comm
INTEGER,OPTIONAL,INTENT(OUT)::ortho_col_comm
INTEGER,OPTIONAL,INTENT(OUT)::ortho_comm_id
INTEGER,OPTIONAL,INTENT(OUT)::ortho_parent_comm
INTEGER,OPTIONAL,INTENT(OUT)::me_blacs
INTEGER,OPTIONAL,INTENT(OUT)::np_blacs
INTEGER,OPTIONAL,INTENT(OUT)::ortho_cntx
INTEGER,OPTIONAL,INTENT(OUT)::world_cntx
LOGICAL,OPTIONAL,INTENT(OUT)::do_distr_diag_inside_bgrp
CHARACTER::JOBZ,UPLO
INTEGER::LDZ,N
REAL(DP)::AP(*),W(*),Z(LDZ,*)
CHARACTER,INTENT(IN)::JOBZ
INTEGER,INTENT(IN)::lda,ldz,nrl,n,nproc,mpime
INTEGER,INTENT(IN)::comm
REAL(DP)::ap(lda,*),w(*),z(ldz,*)
CHARACTER::JOBZ,UPLO
INTEGER::LDZ,N
COMPLEX(DP)::AP(*),Z(LDZ,*)
REAL(DP)::W(*)
CHARACTER::JOBZ
INTEGER,INTENT(IN)::lda,ldz,nrl,n,nproc,mpime
INTEGER,INTENT(IN)::comm
COMPLEX(DP)::ap(lda,*),z(ldz,*)
REAL(DP)::w(*)
REAL(DP),INTENT(IN)::lambda_repl(:,:)
REAL(DP),INTENT(OUT)::lambda_dist(:,:)
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
REAL(DP),INTENT(OUT)::lambda_repl(:,:)
REAL(DP),INTENT(IN)::lambda_dist(:,:)
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
REAL(DP),INTENT(OUT)::lambda_dist(:,:)
INTEGER,INTENT(IN)::i,j
REAL(DP),INTENT(IN)::val
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
REAL(DP),INTENT(IN)::zmat_repl(:,:)
REAL(DP),INTENT(OUT)::zmat_dist(:,:)
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
REAL(DP),INTENT(OUT)::zmat_repl(:,:)
REAL(DP),INTENT(IN)::zmat_dist(:,:)
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
INTEGER,INTENT(OUT)::idesc(LAX_DESC_SIZE)
INTEGER,INTENT(IN)::n
INTEGER,INTENT(IN)::nx
INTEGER,INTENT(IN)::np(2),me(2),comm,cntx
INTEGER,INTENT(IN)::includeme
INTEGER,INTENT(OUT)::idesc(LAX_DESC_SIZE)
INTEGER,INTENT(OUT)::idesc_ip(:,:,:)
INTEGER,INTENT(OUT)::rank_ip(:,:)
INTEGER,INTENT(IN)::n
INTEGER,INTENT(IN)::nx
INTEGER,INTENT(OUT)::i2g
INTEGER,INTENT(OUT)::nl
INTEGER,INTENT(IN)::n
INTEGER,INTENT(IN)::nx
INTEGER,INTENT(IN)::np
INTEGER,INTENT(IN)::me
INTEGER,INTENT(IN)::n
INTEGER,INTENT(IN)::lda,nca,ldb,ncb
REAL(DP)::a(lda,nca),b(ldb,ncb)
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
INTEGER,INTENT(IN)::n
INTEGER,INTENT(IN)::lda,nca,ldb,ncb
COMPLEX(DP)::a(lda,nca),b(ldb,ncb)
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
INTEGER,INTENT(IN)::n
INTEGER,INTENT(IN)::lda,nca,ldb,ncb
REAL(DP)::a(lda,nca),b(ldb,ncb)
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
INTEGER,INTENT(IN)::n
INTEGER,INTENT(IN)::lda,nca,ldb,ncb
COMPLEX(DP)::a(lda,nca),b(ldb,ncb)
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
INTEGER,INTENT(IN)::na
INTEGER,INTENT(IN)::lda
REAL(DP)::a(lda,lda)
INTEGER,INTENT(IN)::idesca(LAX_DESC_SIZE)
INTEGER,INTENT(IN)::nb
INTEGER,INTENT(IN)::ldb
REAL(DP)::b(ldb,ldb)
INTEGER,INTENT(IN)::idescb(LAX_DESC_SIZE)
INTEGER,INTENT(IN)::na
INTEGER,INTENT(IN)::lda
COMPLEX(DP)::a(lda,lda)
INTEGER,INTENT(IN)::idesca(LAX_DESC_SIZE)
INTEGER,INTENT(IN)::nb
INTEGER,INTENT(IN)::ldb
COMPLEX(DP)::b(ldb,ldb)
INTEGER,INTENT(IN)::idescb(LAX_DESC_SIZE)
INTEGER,INTENT(IN)::n
INTEGER,INTENT(IN)::lda
REAL(DP)::a(lda,*)
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
INTEGER,INTENT(IN)::n
INTEGER,INTENT(IN)::lda
REAL(DP),INTENT(INOUT),DEVICE::a(:,:)
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
INTEGER,INTENT(IN)::n
INTEGER,INTENT(IN)::lda
COMPLEX(DP)::a(lda,lda)
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
CHARACTER(LEN=1),INTENT(IN)::what
INTEGER,INTENT(IN)::n
REAL(DP),INTENT(IN)::alpha
INTEGER,INTENT(IN)::lda
REAL(DP)::a(lda,*)
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
CHARACTER(LEN=1),INTENT(IN)::what
INTEGER,INTENT(IN)::n
COMPLEX(DP),INTENT(IN)::alpha
INTEGER,INTENT(IN)::lda
COMPLEX(DP)::a(lda,*)
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
CHARACTER(LEN=1),INTENT(IN)::transa,transb
INTEGER,INTENT(IN)::n
REAL(DP),INTENT(IN)::alpha,beta
INTEGER,INTENT(IN)::lda,ldb,ldc
REAL(DP)::a(lda,*),b(ldb,*),c(ldc,*)
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
CHARACTER(LEN=1),INTENT(IN)::transa,transb
INTEGER,INTENT(IN)::n
REAL(DP),INTENT(IN)::alpha,beta
INTEGER,INTENT(IN)::lda,ldb,ldc
REAL(DP),DEVICE::a(:,:),b(:,:),c(:,:)
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
CHARACTER(LEN=1),INTENT(IN)::transa,transb
INTEGER,INTENT(IN)::n
REAL(SP),INTENT(IN)::alpha,beta
INTEGER,INTENT(IN)::lda,ldb,ldc
REAL(SP)::a(lda,*),b(ldb,*),c(ldc,*)
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
CHARACTER(LEN=1),INTENT(IN)::transa,transb
INTEGER,INTENT(IN)::n
COMPLEX(DP),INTENT(IN)::alpha,beta
INTEGER,INTENT(IN)::lda,ldb,ldc
COMPLEX(DP)::a(lda,*),b(ldb,*),c(ldc,*)
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
INTEGER,INTENT(IN)::n
INTEGER,INTENT(IN)::lda,ldb
REAL(DP)::a(lda,*),b(ldb,*)
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
INTEGER,INTENT(IN)::n
INTEGER,INTENT(IN)::lda,ldb
REAL(SP)::a(lda,*),b(ldb,*)
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
INTEGER,INTENT(IN)::n
INTEGER,INTENT(IN)::lda,ldb
REAL(DP),INTENT(IN),DEVICE::a(:,:)
REAL(DP),INTENT(OUT),DEVICE::b(:,:)
INTEGER,INTENT(IN)::idesc(:)
INTEGER,INTENT(IN)::n
INTEGER,INTENT(IN)::ldx,nx
REAL(DP)::a(ldx,nx),b(ldx,nx)
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
INTEGER,INTENT(IN)::n
INTEGER,INTENT(IN)::ldx,nx
REAL(DP),DEVICE::a(:,:)
REAL(DP),DEVICE::b(:,:)
INTEGER,INTENT(IN)::idesc(LAX_DESC_SIZE)
