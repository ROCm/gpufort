module test

  contains

    INTEGER::current_size=0
    TYPE(fft_type_descriptor),INTENT(in)::desc
    INTEGER,OPTIONAL,INTENT(IN)::howmany
    INTEGER::howmany_
    INTEGER::info
    CHARACTER(LEN=*),INTENT(IN)::calling_routine,message
    INTEGER,INTENT(IN)::ierr
    CHARACTER(LEN=6)::cerr
    INTEGER::info
    TYPE(fft_type_descriptor),INTENT(IN)::dfft
    CHARACTER(LEN=*),INTENT(IN)::fft_kind
    INTEGER,OPTIONAL,INTENT(IN)::howmany
    INTEGER::howmany_=1
    CHARACTER(LEN=12)::clock_label
    TYPE(fft_type_descriptor),INTENT(IN)::dfft
    CHARACTER(LEN=*),INTENT(IN)::fft_kind
    INTEGER,OPTIONAL,INTENT(IN)::howmany
    INTEGER::howmany_=1
    CHARACTER(LEN=12)::clock_label
    TYPE(fft_box_descriptor),INTENT(IN)::dfft
    INTEGER,INTENT(IN)::ia
    TYPE(fft_type_descriptor),INTENT(IN)::dfft
    CHARACTER(LEN=*),INTENT(IN)::fft_kind
    INTEGER,OPTIONAL,INTENT(IN)::howmany
    INTEGER(kind=cuda_stream_kind),OPTIONAL,INTENT(IN)::stream
    INTEGER::howmany_=1
    INTEGER(kind=cuda_stream_kind)::stream_=0
    CHARACTER(LEN=12)::clock_label
    TYPE(fft_type_descriptor),INTENT(IN)::dfft
    CHARACTER(LEN=*),INTENT(IN)::fft_kind
    INTEGER,OPTIONAL,INTENT(IN)::howmany
    INTEGER(kind=cuda_stream_kind),OPTIONAL,INTENT(IN)::stream
    INTEGER::howmany_=1
    INTEGER(kind=cuda_stream_kind)::stream_=0
    CHARACTER(LEN=12)::clock_label
    TYPE(fft_type_descriptor),INTENT(inout)::dfft
    INTEGER::ng,n1,n2,n3
    TYPE(fft_type_descriptor),INTENT(in)::desc
    INTEGER,INTENT(IN)::ispin
    LOGICAL,INTENT(IN)::noncolin,domag
    INTEGER::ierr,ioff,idx,ir3,ir,ipol,ioff_tg,nxyp,npol_
    TYPE(fft_type_descriptor),INTENT(in)::desc
    INTEGER,INTENT(IN)::ispin
    INTEGER::ierr,ioff,idx,ir3,nxyp,ioff_tg
    TYPE(fft_type_descriptor),INTENT(in)::desc
    INTEGER::ierr,from,ir3,ioff,nxyp,ioff_tg
    TYPE(fft_type_descriptor),INTENT(in)::desc
    INTEGER::ierr,from,ir3,ioff,nxyp,ioff_tg
    TYPE(fft_type_descriptor),INTENT(in)::desc
    INTEGER::ierr,from,ir3,ioff,nxyp,ioff_tg
    TYPE(fft_type_descriptor),INTENT(in)::desc
    INTEGER,INTENT(OUT)::right_nnr
    TYPE(fft_type_descriptor),INTENT(in)::desc
    INTEGER,INTENT(OUT)::val
    TYPE(fft_type_descriptor),INTENT(in)::desc
    INTEGER,INTENT(OUT)::val
    TYPE(fft_type_descriptor),INTENT(in)::desc
    INTEGER,INTENT(OUT)::val
    INTEGER::fftx_ntgrp
    TYPE(fft_type_descriptor),INTENT(in)::desc
    INTEGER::fftx_tgpe
    TYPE(fft_type_descriptor),INTENT(in)::desc
    INTEGER::fftx_tgcomm
    TYPE(fft_type_descriptor),INTENT(in)::desc
    TYPE(fft_type_descriptor),INTENT(in)::desc
    INTEGER::nspin,ir
    TYPE(fft_type_descriptor),INTENT(in)::desc
    integer::ig
    TYPE(fft_type_descriptor),INTENT(in)::desc
    integer::ig
    TYPE(fft_type_descriptor),INTENT(in)::desc
    integer::ig
    TYPE(fft_type_descriptor),INTENT(in)::desc
    COMPLEX(DP)::fp,fm
    INTEGER::ig
    TYPE(fft_type_descriptor),INTENT(in)::desc
    COMPLEX(DP)::fp,fm
    INTEGER::ig
    TYPE(fft_type_descriptor),INTENT(in)::desc
    COMPLEX(DP)::fp,fm
    INTEGER::ig
    TYPE(fft_type_descriptor),INTENT(in)::desc
    INTEGER,INTENT(IN)::i,nbsp_bgrp
    INTEGER::eig_offset,eig_index,right_nnr
    INTEGER,INTENT(IN)::unit
    TYPE(fft_type_descriptor),INTENT(in)::desc
    INTEGER::i,j,nr3l
    CHARACTER(LEN=*),INTENT(IN)::fft_kind
    TYPE(fft_type_descriptor),INTENT(IN)::dfft
    INTEGER,OPTIONAL,INTENT(IN)::howmany
    INTEGER,INTENT(IN)::ia
    TYPE(fft_box_descriptor),INTENT(IN)::dfft
    CHARACTER(LEN=*),INTENT(IN)::grid_type
    TYPE(fft_type_descriptor),INTENT(IN)::dfft
    INTEGER,OPTIONAL,INTENT(IN)::howmany
    INTEGER(kind=cuda_stream_kind),OPTIONAL,INTENT(IN)::stream
    CHARACTER(LEN=*),INTENT(IN)::fft_kind
    TYPE(fft_type_descriptor),INTENT(IN)::dfft
    INTEGER,OPTIONAL,INTENT(IN)::howmany
    CHARACTER(LEN=*),INTENT(IN)::grid_type
    TYPE(fft_type_descriptor),INTENT(IN)::dfft
    INTEGER,OPTIONAL,INTENT(IN)::howmany
    INTEGER(kind=cuda_stream_kind),OPTIONAL,INTENT(IN)::stream
    TYPE(fft_type_descriptor),INTENT(IN)::dfft_in,dfft_out
    TYPE(fft_type_descriptor),INTENT(IN)::dfft_in,dfft_out
    TYPE(fft_type_descriptor),INTENT(IN)::dfft_in,dfft_out
    INTEGER::ngm
    TYPE(fft_type_descriptor),INTENT(IN)::dfft_in,dfft_out
    INTEGER::ngm
    TYPE(fft_type_descriptor),INTENT(in)::dfft
    INTEGER,INTENT(in)::isgn
    INTEGER::n1,n2,n3,nx1,nx2,nx3
    INTEGER::nnr_
    INTEGER::nsticks_x,nsticks_y,nsticks_z
    INTEGER::i
    TYPE(fft_type_descriptor),INTENT(in)::dfft
    INTEGER,INTENT(in)::isgn
    INTEGER::n1,n2,n3,nx1,nx2,nx3
    INTEGER::nnr_
    INTEGER::nsticks_x,nsticks_y,nsticks_z
    INTEGER::ierr,i
    INTEGER(kind=cuda_stream_kind)::stream=0
    TYPE(fft_type_descriptor),INTENT(in)::dfft
    INTEGER,INTENT(in)::isgn
    INTEGER,INTENT(in)::howmany
    INTEGER::n1,n2,n3,nx1,nx2,nx3
    INTEGER::nnr_
    INTEGER::nsticks_x,nsticks_y,nsticks_z
    INTEGER::nsticks_zx
    INTEGER::ierr,i,j
    INTEGER::nstreams
    INTEGER(kind=cuda_stream_kind)::stream=0
    TYPE(fft_type_descriptor),INTENT(IN)::dfft
    INTEGER,INTENT(IN)::i,j,k
    INTEGER::kk,ii,jj,ip,ierr
    COMPLEX(DP)::f_aux
    TYPE(fft_type_descriptor),INTENT(IN)::dfft
    INTEGER,INTENT(IN)::i,j,k
    COMPLEX(DP),INTENT(IN)::f_in
    INTEGER::kk,ii,jj,ip,ierr
    INTEGER,INTENT(IN)::i,j,k
    TYPE(fft_type_descriptor),INTENT(IN)::dfft
    INTEGER::ii,jj,ip,ierr
    COMPLEX(DP)::f_aux
    COMPLEX(DP),INTENT(IN)::f_in
    INTEGER,INTENT(IN)::i,j,k
    TYPE(fft_type_descriptor),INTENT(IN)::dfft
    INTEGER::ii,jj
    TYPE(fft_type_descriptor),INTENT(in)::dfft
    INTEGER,INTENT(in)::isgn
    INTEGER::me_p
    INTEGER::n1,n2,n3,nx1,nx2,nx3
    INTEGER,INTENT(in)::iopt
    INTEGER,INTENT(in)::iopt
    TYPE(fft_type_descriptor),INTENT(in)::dfft
    INTEGER,INTENT(in)::isgn
    INTEGER::me_p,istat
    INTEGER::n1,n2,n3,nx1,nx2,nx3
    INTEGER(kind=cuda_stream_kind)::stream=0
    INTEGER,INTENT(in)::iopt
    INTEGER,INTENT(in)::iopt
    TYPE(fft_type_descriptor),INTENT(in)::dfft
    INTEGER,INTENT(in)::isgn
    INTEGER,INTENT(in)::batchsize
    INTEGER::me_p,istat,i,j,currsize
    INTEGER::n1,n2,n3,nx1,nx2,nx3,ncpx,nppx,proc
    INTEGER(kind=cuda_stream_kind)::stream=0
    INTEGER,PARAMETER::MPI_COMM_NULL=0
    INTEGER,PARAMETER::ndims=10
    INTEGER,PARAMETER::nfftx=2049
    INTEGER,PARAMETER::stdout=6
    REAL(DP),PARAMETER::eps8=1.0E-8_DP
    INTEGER,INTENT(IN)::isign
    INTEGER,INTENT(IN)::nsl,nz,ldz
    REAL(DP)::tscale
    INTEGER::i,err,idir,ip,void
    INTEGER,SAVE::icurrent=1
    LOGICAL::found
    INTEGER::tid
    INTEGER::offset,ldz_t
    INTEGER::omp_get_max_threads
    INTEGER,PARAMETER::ltabl=3*nfftx+100
    INTEGER::INFO
    INTEGER,INTENT(IN)::isign,ldx,ldy,nx,ny,nzl
    INTEGER::i,k,j,err,idir,ip,kk,void
    REAL(DP)::tscale
    INTEGER,SAVE::icurrent=1
    INTEGER,PARAMETER::stdout=6
    INTEGER::offset
    INTEGER::nx_t,ny_t,nzl_t,ldx_t,ldy_t
    INTEGER::itid,mytid,ntids
    INTEGER::omp_get_thread_num,omp_get_num_threads,omp_get_max_threads
    INTEGER,PARAMETER::ltabl=3*nfftx+100
    INTEGER::INFO
    INTEGER,INTENT(IN)::nx,ny,nz,ldx,ldy,ldz,howmany,isign
    INTEGER::i,k,j,err,idir,ip
    REAL(DP)::tscale
    INTEGER,SAVE::icurrent=1
    INTEGER,PARAMETER::ltabl=4*nfftx+300
    INTEGER::INFO
    integer::nx,ny,nz,ldx,ldy,ldz,howmany,isign
    integer::m,incx1,incx2
    INTEGER::i,k,j,err,idir,ip,ii,jj
    REAL(DP)::tscale
    INTEGER,SAVE::icurrent=1
    INTEGER,PARAMETER::ltabl=3*nfftx+100
    INTEGER::INFO
    TYPE(DFTI_DESCRIPTOR),POINTER::desc
    INTEGER,INTENT(IN)::isign
    INTEGER,INTENT(IN)::nsl,nz,ldz
    REAL(DP)::tscale
    INTEGER::i,err,idir,ip,void
    INTEGER,SAVE::icurrent=1
    LOGICAL::found
    INTEGER::tid
    INTEGER::offset,ldz_t
    INTEGER::omp_get_max_threads
    LOGICAL,SAVE::dfti_first=.TRUE.
    INTEGER::dfti_status=0
    INTEGER,INTENT(IN)::isign,ldx,ldy,nx,ny,nzl
    INTEGER::i,k,j,err,idir,ip,kk,void
    REAL(DP)::tscale
    INTEGER,SAVE::icurrent=1
    INTEGER,PARAMETER::stdout=6
    INTEGER::offset
    INTEGER::nx_t,ny_t,nzl_t,ldx_t,ldy_t
    INTEGER::itid,mytid,ntids
    INTEGER::omp_get_thread_num,omp_get_num_threads,omp_get_max_threads
    LOGICAL,SAVE::dfti_first=.TRUE.
    INTEGER::dfti_status=0
    INTEGER,INTENT(IN)::nx,ny,nz,ldx,ldy,ldz,howmany,isign
    INTEGER::i,k,j,err,idir,ip
    REAL(DP)::tscale
    INTEGER,SAVE::icurrent=1
    LOGICAL,SAVE::dfti_first=.TRUE.
    INTEGER::dfti_status=0
    integer::nx,ny,nz,ldx,ldy,ldz,isign,howmany
    INTEGER,INTENT(IN)::isign
    INTEGER,INTENT(IN)::nsl,nz,ldz
    REAL(DP)::tscale
    INTEGER::i,err,idir,ip,void
    INTEGER,SAVE::icurrent=1
    LOGICAL::done
    INTEGER::tid
    INTEGER::offset,ldz_t
    INTEGER::omp_get_max_threads
    INTEGER,PARAMETER::ltabl=20000+3*nfftx
    INTEGER,INTENT(IN)::isign,ldx,ldy,nx,ny,nzl
    INTEGER::i,k,j,err,idir,ip,kk,void
    REAL(DP)::tscale
    INTEGER,SAVE::icurrent=1
    INTEGER,PARAMETER::stdout=6
    INTEGER::offset
    INTEGER::nx_t,ny_t,nzl_t,ldx_t,ldy_t
    INTEGER::itid,mytid,ntids
    INTEGER::omp_get_thread_num,omp_get_num_threads,omp_get_max_threads
    INTEGER,PARAMETER::ltabl=20000+3*nfftx
    INTEGER,INTENT(IN)::nx,ny,nz,ldx,ldy,ldz,howmany,isign
    INTEGER::i,k,j,err,idir,ip
    REAL(DP)::tscale
    INTEGER,SAVE::icurrent=1
    integer::nx,ny,nz,ldx,ldy,ldz,howmany,isign
    integer::m,incx1,incx2
    INTEGER::i,k,j,err,idir,ip,ii,jj
    REAL(DP)::tscale
    INTEGER,SAVE::icurrent=1
    INTEGER,PARAMETER::ltabl=20000+3*nfftx
    INTEGER,INTENT(IN)::isign
    INTEGER,INTENT(IN)::nsl,nz,ldz
    REAL(DP)::tscale
    INTEGER::i,err,idir,ip,void
    INTEGER,SAVE::icurrent=1
    LOGICAL::found
    INTEGER::tid
    INTEGER::offset,ldz_t
    INTEGER::omp_get_max_threads
    INTEGER,INTENT(IN)::isign,ldx,ldy,nx,ny,nzl
    INTEGER::i,k,j,err,idir,ip,kk,void
    REAL(DP)::tscale
    INTEGER,SAVE::icurrent=1
    INTEGER,PARAMETER::stdout=6
    INTEGER::offset
    INTEGER::nx_t,ny_t,nzl_t,ldx_t,ldy_t
    INTEGER::itid,mytid,ntids
    INTEGER::omp_get_thread_num,omp_get_num_threads,omp_get_max_threads
    INTEGER,INTENT(IN)::nx,ny,nz,ldx,ldy,ldz,howmany,isign
    INTEGER::i,k,j,err,idir,ip
    REAL(DP)::tscale
    INTEGER,SAVE::icurrent=1
    integer::nx,ny,nz,ldx,ldy,ldz,howmany,isign
    integer::m,incx1,incx2
    INTEGER::i,k,j,err,idir,ip,ii,jj,h,ldh
    REAL(DP)::tscale
    INTEGER,SAVE::icurrent=1
    INTEGER,INTENT(IN)::isign
    INTEGER,INTENT(IN)::nsl,nz,ldz
    REAL(DP)::tscale
    INTEGER::i,err,idir,ip,void
    INTEGER,SAVE::icurrent=1
    LOGICAL::done
    INTEGER::tid
    INTEGER::offset,ldz_t
    INTEGER::omp_get_max_threads
    INTEGER,INTENT(IN)::isign,ldx,ldy,nx,ny,nzl
    INTEGER::i,k,j,err,idir,ip,kk,void
    REAL(DP)::tscale
    INTEGER,SAVE::icurrent=1
    INTEGER,PARAMETER::stdout=6
    INTEGER::offset
    INTEGER::nx_t,ny_t,nzl_t,ldx_t,ldy_t
    INTEGER::itid,mytid,ntids
    INTEGER::omp_get_thread_num,omp_get_num_threads,omp_get_max_threads
    INTEGER,INTENT(IN)::nx,ny,nz,ldx,ldy,ldz,howmany,isign
    INTEGER::i,k,j,err,idir,ip
    REAL(DP)::tscale
    INTEGER,SAVE::icurrent=1
    INTEGER,PARAMETER::stdout=6
    integer::nx,ny,nz,ldx,ldy,ldz,howmany,isign
    integer::m,incx1,incx2
    INTEGER::i,k,j,err,idir,ip,ii,jj
    REAL(DP)::tscale
    INTEGER,SAVE::icurrent=1
    INTEGER,INTENT(IN)::isign
    INTEGER,INTENT(IN)::nsl,nz,ldz
    REAL(DP)::tscale
    INTEGER::i,err,idir,ip,void
    INTEGER,SAVE::icurrent=1
    LOGICAL::done
    INTEGER::tid
    INTEGER::offset,ldz_t
    INTEGER::omp_get_max_threads
    INTEGER,PARAMETER::ltabl=2*nfftx+64
    COMPLEX(DP)::DUMMY
    INTEGER,SAVE::isys=1
    INTEGER,INTENT(IN)::isign,ldx,ldy,nx,ny,nzl
    INTEGER::i,k,j,err,idir,ip,kk,void
    REAL(DP)::tscale
    INTEGER,SAVE::icurrent=1
    INTEGER,PARAMETER::stdout=6
    INTEGER::offset
    INTEGER::nx_t,ny_t,nzl_t,ldx_t,ldy_t
    INTEGER::itid,mytid,ntids
    INTEGER::omp_get_thread_num,omp_get_num_threads,omp_get_max_threads
    INTEGER,PARAMETER::ltabl=2*nfftx+64
    COMPLEX(DP)::DUMMY
    INTEGER,SAVE::isys=1
    INTEGER,INTENT(IN)::nx,ny,nz,ldx,ldy,ldz,howmany,isign
    INTEGER::i,k,j,err,idir,ip
    REAL(DP)::tscale
    INTEGER,SAVE::icurrent=1
    INTEGER,PARAMETER::ltabl=60
    INTEGER,PARAMETER::lwork=195+6*nfftx
    INTEGER::k_off,kj_offset
    COMPLEX(DP),DIMENSION(:),ALLOCATABLE::cw2
    INTEGER::nbtasks
    integer::nx,ny,nz,ldx,ldy,ldz,howmany,isign
    integer::m,incx1,incx2
    INTEGER::i,k,j,err,idir,ip,ii,jj
    REAL(DP)::tscale
    INTEGER,SAVE::icurrent=1
    INTEGER,INTENT(IN)::isign
    INTEGER,INTENT(IN)::nsl,nz,ldz
    INTEGER(kind=cuda_stream_kind)::stream
    LOGICAL,INTENT(IN),optional::in_place
    REAL(DP)::tscale
    INTEGER::i,err,idir,ip,void,istat
    INTEGER,SAVE::icurrent=1
    LOGICAL::found
    LOGICAL::is_inplace
    INTEGER::tid
    INTEGER,PARAMETER::RANK=1
    INTEGER::STRIDE,DIST,BATCH
    INTEGER,INTENT(IN)::isign,ldx,ldy,nx,ny,nzl
    INTEGER(kind=cuda_stream_kind)::stream
    INTEGER::i,k,j,err,idir,ip,kk,void,istat
    REAL(DP)::tscale
    INTEGER,SAVE::icurrent=1
    INTEGER,PARAMETER::stdout=6
    INTEGER::batch_1,batch_2
    INTEGER,PARAMETER::RANK=2
    INTEGER::STRIDE,DIST,BATCH
    INTEGER,PARAMETER::RANK=1
    INTEGER::STRIDE_X,STRIDE_Y,DIST_X,DIST_Y,BATCH_X,BATCH_Y1,BATCH_Y2
    INTEGER,INTENT(IN)::nx,ny,nz,ldx,ldy,ldz,howmany,isign
    INTEGER(kind=cuda_stream_kind)::stream
    INTEGER::i,k,j,err,idir,ip,istat
    REAL(DP)::tscale
    INTEGER,SAVE::icurrent=1
    INTEGER,PARAMETER::RANK=3
    INTEGER::STRIDE,DIST,BATCH
    INTEGER,PARAMETER::stdout=6
    integer::nx,ny,nz,ldx,ldy,ldz,howmany,isign
    integer(kind=cuda_stream_kind)::stream
    integer::m,incx1,incx2
    INTEGER::i,k,j,err,idir,ip,ii,jj,istat
    REAL(DP)::tscale
    INTEGER,SAVE::icurrent=1
    INTEGER,PARAMETER::RANK=3
    INTEGER::i
    INTEGER,PARAMETER::ndims=3
    TYPE(C_PTR)::cft_b_bw_planz=C_NULL_PTR
    TYPE(C_PTR)::cft_b_bw_planx=C_NULL_PTR
    TYPE(C_PTR)::cft_b_bw_plany=C_NULL_PTR
    real(DP)::tscale
    integer::ip,i,first_index,how_many_y
    integer,save::icurrent=1
    integer,INTENT(IN)::nx,ny,nz
    integer,INTENT(IN)::nx,ny,nz,ldx,ldy,ldz,imin2,imax2,imin3,imax3,sgn
    INTEGER,SAVE::k,first_index,how_many_y
    INTEGER::stdout=6
    INTEGER::nr1=0!
    INTEGER::nr2=0
    INTEGER::nr3=0!
    INTEGER::nr1x=0
    INTEGER::nr2x=0
    INTEGER::nr3x=0
    INTEGER::nnr=0
    INTEGER::mype=0
    INTEGER::comm=0
    INTEGER::nproc=1
    INTEGER::root=0
    TYPE(fft_box_descriptor)::desc
    INTEGER,INTENT(in)::nat,nproc,mype,root,comm
    TYPE(fft_box_descriptor)::desc
    TYPE(fft_box_descriptor),INTENT(INOUT)::desc
    INTEGER,INTENT(in)::nat
    TYPE(fft_type_descriptor),INTENT(IN)::dfftp
    INTEGER::nr1b,nr2b,nr3b,nr1bx,nr2bx,nr3bx
    INTEGER::isa
    INTEGER::ir2,ibig2,irb2,imin2,imax2,nr2
    INTEGER::ir3,ibig3,irb3,imin3,imax3,nr3
    INTEGER::n,nx
    REAL(DP)::log2n
    integer::nr
    logical::allowed
    integer::mr,i,fac,p,maxpwr
    INTEGER,INTENT(IN)::nr
    INTEGER,OPTIONAL,INTENT(IN)::np
    INTEGER::new
    INTEGER::nr1=0!
    INTEGER::nr2=0
    INTEGER::nr3=0!
    INTEGER::nr1x=0
    INTEGER::nr2x=0
    INTEGER::nr3x=0
    LOGICAL::lpara=.FALSE.
    LOGICAL::lgamma=.FALSE.
    INTEGER::root=0
    INTEGER::comm=MPI_COMM_NULL
    INTEGER::comm2=MPI_COMM_NULL
    INTEGER::comm3=MPI_COMM_NULL
    INTEGER::nproc=1
    INTEGER::nproc2=1
    INTEGER::nproc3=1
    INTEGER::mype=0
    INTEGER::mype2=0
    INTEGER::mype3=0
    INTEGER::my_nr3p=0
    INTEGER::my_nr2p=0
    INTEGER::my_i0r3p=0
    INTEGER::my_i0r2p=0
    INTEGER::nr1w_tg
    INTEGER::nst
    INTEGER::ngm
    INTEGER::ngw
    INTEGER::nnp=0
    INTEGER::nnr=0
    INTEGER::nnr_tg=0
    LOGICAL::has_task_groups=.FALSE.
    LOGICAL::use_pencil_decomposition=.FALSE.
    CHARACTER(len=12)::rho_clock_label=''
    CHARACTER(len=12)::wave_clock_label=''
    INTEGER::grid_id
    INTEGER(kind=cuda_stream_kind),allocatable,dimension(:)::stream_scatter_yz
    INTEGER(kind=cuda_stream_kind),allocatable,dimension(:)::stream_many
    INTEGER::nstream_many=16
    INTEGER(kind=cuda_stream_kind)::a2a_comp
    INTEGER(kind=cuda_stream_kind),allocatable,dimension(:)::bstreams
    TYPE(cudaEvent),allocatable,dimension(:)::bevents
    INTEGER::batchsize=16
    INTEGER::subbatchsize=4
    REAL(DP)::fft_dual=4.0d0
    INTEGER::incremental_grid_identifier=0
    TYPE(fft_type_descriptor)::desc
    REAL(DP),INTENT(IN)::gcutm
    INTEGER,INTENT(IN),OPTIONAL::nyfft
    INTEGER,INTENT(in)::comm
    INTEGER::nx,ny,ierr,imany,nzfft
    INTEGER::i,nsubbatches
    INTEGER::mype,root,nproc,nproc2,nproc3,iproc,iproc2,iproc3
    INTEGER::color,key,comm2,comm3
    TYPE(fft_type_descriptor)::desc
    INTEGER::iproc,ierr,imany
    INTEGER::i,nsubbatches
    TYPE(fft_type_descriptor)::desc
    INTEGER,INTENT(in)::nst
    INTEGER::np,nq,i,is,iss,itg,i1,i2,m1,m2,ip
    INTEGER::ncpx,nr1px,nr2px,nr3px
    INTEGER::nr1,nr2,nr3
    INTEGER::nr1x,nr2x,nr3x
    TYPE(fft_type_descriptor),INTENT(INOUT)::dfft
    TYPE(sticks_map),INTENT(INOUT)::smap
    CHARACTER(LEN=*),INTENT(IN)::pers
    LOGICAL,INTENT(IN)::lpara
    LOGICAL,INTENT(IN)::lgamma
    INTEGER,INTENT(IN)::comm
    REAL(DP),INTENT(IN)::gcut_in
    REAL(DP),OPTIONAL,INTENT(IN)::dual_in
    INTEGER,INTENT(IN)::nyfft
    LOGICAL,OPTIONAL,INTENT(IN)::use_pd
    INTEGER::nst
    INTEGER::nstw
    REAL(DP)::gcut,gkcut,dual
    INTEGER::ngm,ngw
    REAL(DP),INTENT(IN)::gcutm
    TYPE(fft_type_descriptor),INTENT(INOUT)::dfft
    TYPE(fft_type_descriptor),INTENT(IN)::dfft
    INTEGER,INTENT(INOUT)::nr1,nr2,nr3
    TYPE(fft_type_descriptor),INTENT(IN)::desc
    INTEGER::fft_stick_index
    INTEGER,INTENT(IN)::i,j
    INTEGER::mc,m1,m2
    TYPE(C_PTR)::plan
    INTEGER(KIND=C_INT)::nz,i
    TYPE(C_PTR)::plan
    TYPE(C_PTR)::plan
    INTEGER(KIND=C_INT)::nx,ny,i
    TYPE(C_PTR)::plan
    TYPE(C_PTR)::plan
    INTEGER(KIND=C_INT)::nx,ny,nz,i
    TYPE(C_PTR)::plan
    TYPE(C_PTR)::plan
    INTEGER(KIND=C_INT)::nx,ny,nz,ldx,ldy
    COMPLEX(KIND=C_DOUBLE)::xy
    TYPE(C_PTR)::plan
    INTEGER(KIND=C_INT)::nx,ny,nz,ldx,ldy
    COMPLEX(KIND=C_DOUBLE)::xy
    TYPE(C_PTR)::plan
    INTEGER(KIND=C_INT)::ny,ldx
    COMPLEX(KIND=C_DOUBLE)::xy
    TYPE(C_PTR)::plan
    INTEGER(KIND=C_INT)::ldz,nzl
    COMPLEX(KIND=C_DOUBLE)::z
    TYPE(C_PTR)::plan
    INTEGER(KIND=C_INT)::ldz
    COMPLEX(KIND=C_DOUBLE)::z
    TYPE(C_PTR)::plan
    INTEGER(KIND=C_INT)::m,inc1,inc2
    COMPLEX(KIND=C_DOUBLE)::z
    TYPE(C_PTR)::plan
    INTEGER(KIND=C_INT)::m,inc1,inc2
    COMPLEX(KIND=C_DOUBLE)::z
    integer,character(len=256),integer(C_INT16_T)::version=1
    integer(C_INT16_T)::size=48!
    integer(C_INT)::category=0
    integer(C_INT)::colorType=1
    integer(C_INT)::color
    integer(C_INT)::payloadType=0
    integer(C_INT)::reserved0
    integer(C_INT64_T)::payload
    integer(C_INT)::messageType=1
    type(C_PTR)::message
    character(kind=C_CHAR,len=*)::name
    character(kind=c_char,len=*)::name
    integer,optional::id
    integer::istat
    character(kind=c_char,len=*)::name
    integer,optional::id
    integer::istat
    TYPE(fft_type_descriptor),INTENT(in)::desc
    INTEGER,INTENT(in)::nxx_,isgn
    INTEGER,INTENT(in)::nr2px,nproc2,my_nr2p
    INTEGER::ierr,me2,iproc2,ncpx
    INTEGER::i,it,j,k,kfrom,kdest,mc,m1,m3,i1,icompact,sendsize
    TYPE(fft_type_descriptor),INTENT(in)::desc
    INTEGER,INTENT(in)::nxx_,isgn
    INTEGER,INTENT(in)::me2_start,me2_end
    INTEGER::ierr,me2,me3,nproc3,iproc3,ncpx,nr3px,ip
    INTEGER::i,it,k,kfrom,kdest,mc,m1,m2,i1,sendsize
    INTEGER::my_nr1p_
    TYPE(fft_type_descriptor),INTENT(in)::desc
    INTEGER,INTENT(in)::nxx_,isgn
    INTEGER::ierr
    TYPE(fft_type_descriptor),INTENT(in)::desc
    INTEGER,INTENT(in)::nxx_,isgn
    INTEGER::ierr
    TYPE(fft_type_descriptor),INTENT(IN)::dfft
    INTEGER::proc,info,offset_in,offset_aux,ir3
    TYPE(fft_type_descriptor),INTENT(IN)::dfft
    INTEGER::proc,info,offset_in,offset_aux,ir3
    TYPE(fft_type_descriptor),INTENT(IN)::dfft
    INTEGER::proc,info,offset_in,offset_aux,ir3
    TYPE(fft_type_descriptor),INTENT(IN)::dfft
    INTEGER::proc,info,offset_in,offset_aux,ir3
    TYPE(fft_type_descriptor),INTENT(in)::dfftp
    INTEGER::proc,info,offset_in,offset_aux,ir3
    TYPE(fft_type_descriptor),INTENT(in)::dfftp
    INTEGER::proc_,proc2_,proc3_,proc,info,offset_in,offset_aux,ir3,nr2px
    INTEGER::ibnd,jbnd,iii
    TYPE(fft_type_descriptor),INTENT(in)::dfftp
    INTEGER::target_ibnd
    INTEGER::proc_,proc2_,proc3_,proc,info,offset_out,offset_aux,ir3
    INTEGER::ibnd,jbnd
    integer::n
    integer::i,ir,j,l
    TYPE(fft_type_descriptor),INTENT(in)::dfft
    INTEGER::k,offset,proc,ierr,me,nprocp,gproc,i,kdest,kfrom
    INTEGER::me_p,nppx,mc,j,npp,nnp,ii,it,ip,ioff,sendsiz,ncpx,ipp,nsiz
    TYPE(fft_type_descriptor),TARGET,INTENT(in)::dfft
    INTEGER::cuf_i,cuf_j,nswip
    INTEGER::istat
    INTEGER::k,offset,proc,ierr,me,nprocp,gproc,gcomm,i,kdest,kfrom
    INTEGER::me_p,nppx,mc,j,npp,nnp,ii,it,ip,ioff,sendsiz,ncpx,ipp,nblk,nsiz
    INTEGER::iter,dest,sorc
    TYPE(fft_type_descriptor),TARGET,INTENT(in)::dfft
    INTEGER,INTENT(IN)::batchsize
    INTEGER::cuf_i,cuf_j,nswip
    INTEGER::istat
    INTEGER::k,offset,proc,ierr,me,nprocp,gproc,gcomm,i,kdest,kfrom
    INTEGER::me_p,nppx,mc,j,npp,nnp,nnr,ii,it,ip,ioff,sendsiz,ncpx,ipp,nblk,nsiz
    INTEGER::iter,dest,sorc
    TYPE(fft_type_descriptor),TARGET,INTENT(in)::dfft
    INTEGER,INTENT(IN)::batchsize,batch_id
    INTEGER::istat
    INTEGER::k,offset,proc,ierr,me,nprocp,gproc,gcomm,i,kdest,kfrom
    INTEGER::me_p,nppx,mc,j,npp,nnp,nnr,ii,it,ip,ioff,sendsiz,ncpx,ipp,nblk,nsiz
    INTEGER,ALLOCATABLE,DIMENSION(:)::offset_proc
    INTEGER::iter,dest,sorc
    TYPE(fft_type_descriptor),TARGET,INTENT(in)::dfft
    INTEGER,INTENT(IN)::batchsize,batch_id
    INTEGER::cuf_i,cuf_j,nswip
    INTEGER::istat
    INTEGER::k,offset,proc,ierr,me,nprocp,gproc,gcomm,i,kdest,kfrom
    INTEGER::me_p,nppx,mc,j,npp,nnp,nnr,ii,it,ip,ioff,sendsiz,ncpx,ipp,nblk,nsiz
    INTEGER::iter,dest,sorc,req_cnt
    TYPE(fft_type_descriptor),TARGET,INTENT(in)::dfft
    INTEGER,INTENT(IN)::batchsize,batch_id

end module test
